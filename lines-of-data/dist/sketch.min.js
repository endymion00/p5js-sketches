/**
 * Lines of Data.
 * Website => https://www.fal-works.com/
 * @copyright 2019 FAL
 * @author FAL <contact@fal-works.com>
 * @version 0.1.2
 * @license CC-BY-SA-3.0
 */
!function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;const e=(t,e)=>{const{array:n,size:o}=t;for(let t=0;t<o;t+=1)e(n[t])},n=t=>document.getElementById(t)||document.body,o=(t,e)=>{const n=t.length;for(let o=0;o<n;o+=1)e(t[o],o,t)};let r,s;const a=t=>{r=t},i=(t,e,n)=>{const{x:o,y:r}=e;return o>=n&&r>=n&&o<t.width-n&&r<t.height-n},c=(t,e,n,o)=>{r.translate(e,n),((t,e)=>{r.rotate(e),t(),r.rotate(-e)})(t,o),r.translate(-e,-n)},l=(t,e,o,s)=>{const a=((t,e,n)=>{switch(n){default:case"FIT_TO_BOX":return Math.min(e.width/t.width,e.height/t.height);case"FIT_WIDTH":return e.width/t.width;case"FIT_HEIGHT":return e.height/t.height}})(e,(t=>t===document.body?{width:window.innerWidth,height:window.innerHeight}:t.getBoundingClientRect())("string"==typeof t?n(t):t),o);return{p5Canvas:r.createCanvas(a*e.width,a*e.height,s),scaleFactor:a,logicalSize:e,drawScaled:t=>((t,e)=>{r.scale(e),t(),r.scale(1/e)})(t,a),logicalCenterPosition:{x:e.width/2,y:e.height/2}}},h=[];let d=!1;const g=2*Math.PI,u=(t,e)=>Math.abs(t-e)<1e-13,p=[248,248,252],m=(t=>{const e=new Array(t),n=g/t;for(let o=0;o<t;o+=1)e[o]=o*n;return e})(8),w={start:50,end:150},f={start:2,end:15},y={start:3,end:20},M={start:40,end:160},C={start:20,end:600},S=["#7189bf","#df7599","#ffc785","#72d6c9","#202020"],x=(t,e,n)=>({x:t.x+n*Math.cos(e),y:t.y+n*Math.sin(e)});class P{constructor(t){this.factory=t,this.value=void 0}get(){return this.value||(this.value=this.factory())}clear(){return this.value=void 0,this}}const R=t=>new P(t),z=t=>((t,e)=>t+Math.random()*(e-t))(t.start,t.end),v=(t,e)=>((t,e,n)=>t+Math.pow(Math.random(),n)*(e-t))(t.start,t.end,e),I=t=>t[(t=>Math.floor(Math.random()*t))(t.length)],b=t=>Math.random()<t,k=t=>t*t,T=()=>{},O=t=>{t.count=0,t.progressRatio=0,t.isCompleted=!1},E=(t,e=T,n=T)=>({duration:t,progressRatioChangeRate:1/t,onProgress:e,onComplete:n,count:0,progressRatio:0,isCompleted:!1}),q=E(0),F=(t,e)=>{const n=Object.assign({},t);return n.onComplete=()=>{t.onComplete(n),e(n)},n},H=(t,e)=>{t.index=e,t.current=t.units[e]},_=(t,e=!1)=>{let n;const r=new Array(t.length),s=()=>(t=>H(t,t.index+1))(n),a=t.length-1;for(let e=0;e<a;e+=1)r[e]=F(t[e],s);return r[a]=e?F(t[a],()=>(t=>{o(t.units,O),H(t,0)})(n)):t[a],n={units:r,current:r[0],index:0}},A=(_([q]),R(()=>S.map(t=>r.color(t)))),B=R(()=>r.color("#202020")),W=(t,e)=>{const n=[];let o=e;for(;o<t;){const e=Math.min(t,o+v(f,3));n.push({color:I(A.get()),start:o,end:e}),o=e,o+=v(b(.8)?y:M,2)}return n},D=(t,e,n,o)=>{const s=t.length,a=10*(o?-1:1);for(let o=0;o<s;o+=1){const{color:s,start:i,end:c}=t[o];c<e||(n<i||(r.fill(s),r.rect(Math.max(e,i),0,Math.min(n,c),a)))}},L=t=>{const{x:e,y:n}=t.startPoint;c(t.graphics.draw,e,n,t.angle)},j=t=>(t=>{const{isCompleted:e,count:n,duration:o,progressRatioChangeRate:r}=t;if(!e){if(n>=o)return t.progressRatio=1,t.onProgress(t),t.isCompleted=!0,void t.onComplete(t);t.onProgress(t),t.count+=1,t.progressRatio+=r}})(t.timers.current),G=(t,e,n,o)=>{const a=(t=>{const e={start:0,end:0},n=t.length;return{data:t,trimRatio:e,draw:()=>{const o=e.start*n,s=e.end*n;D(t.leftSequence,o,s,!0),D(t.rightSequence,o,s,!1),r.stroke(B.get()),r.line(o,0,s,0),r.noStroke()}}})((t=>({length:t,leftSequence:W(t,0),rightSequence:W(t,z(w))}))(n)),{data:c,trimRatio:l}=a;let h;const d=Math.ceil(1/15*c.length),g=E(d,t=>{l.end=(t=>(t=>t*t*t)(t-1)+1)(t.progressRatio)},()=>{for(let r=0;r<1e3;r+=1){const r=x(t,e,n),a=I(m);if(e===a||u(Math.abs(e-a),Math.PI))continue;const c=z(C),l=x(r,a,c);if(i(s.logicalSize,l,80)){G(r,a,c,o);break}}}),p=E(30),f=E(d,t=>{l.start=k(t.progressRatio)},()=>{h.needsSweep=!0}),y=_([g,p,f]);return o(h={startPoint:t,angle:e,graphics:a,timers:y,onCreate:o,needsSweep:!1}),h};let N,X;const J=()=>{e(N,j),e(N,L),(t=>{const{array:e,size:n}=t;let o=0;for(let t=0;t<n;t+=1){const n=e[t];n.needsSweep||(e[o]=n,o+=1)}t.size=o})(N)},K=()=>{X(),s.drawScaled(J)},Q=()=>{},U=()=>{switch(r.key){case"p":d?(r.loop(),d=!1):(r.noLoop(),d=!0);break;case"s":r.save("image.png")}};(e=>{const r=n(e.htmlElementId);new t(t=>{a(t),t.setup=()=>{(t=>{s=t})(l(r,e.logicalCanvasSize)),e.initialize(),o(h,e=>e(t)),h.length=0},e.setP5Methods(t)},r)})({htmlElementId:"LinesOfData",logicalCanvasSize:{width:800,height:800},initialize:()=>{const t=r.color(p);X=(t=>{r.pixels=t,r.updatePixels()}).bind(null,(t=>(r.push(),t(),r.pop(),r.loadPixels(),r.pixels))(()=>r.background(t))),r.noStroke(),r.strokeWeight(2),r.rectMode(r.CORNERS),N=(t=>({array:new Array(t),size:0}))(32),(()=>{(t=>{t.size=0})(N);const t=t=>((t,e)=>{t.array[t.size]=e,t.size+=1})(N,t);G({x:100,y:200},0,600,t),G({x:700,y:600},Math.PI,600,t)})()},setP5Methods:t=>{t.draw=K,t.mousePressed=Q,t.keyTyped=U}})}(p5);