/**
 * Lines of Data.
 * Website => https://www.fal-works.com/
 * @copyright 2019 FAL
 * @author FAL <contact@fal-works.com>
 * @version 0.1.1
 * @license CC-BY-SA-3.0
 */
!function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;const e=(t,e)=>{const{array:n,size:o}=t;for(let t=0;t<o;t+=1)e(n[t])},n=t=>document.getElementById(t)||document.body;let o,r;const s=t=>{o=t},a=(t,e,n)=>{const{x:o,y:r}=e;return o>=n&&r>=n&&o<t.width-n&&r<t.height-n},i=(t,e,n,r)=>{o.translate(e,n),((t,e)=>{o.rotate(e),t(),o.rotate(-e)})(t,r),o.translate(-e,-n)},c=(t,e,r,s)=>{const a=((t,e,n)=>{switch(n){default:case"FIT_TO_BOX":return Math.min(e.width/t.width,e.height/t.height);case"FIT_WIDTH":return e.width/t.width;case"FIT_HEIGHT":return e.height/t.height}})(e,(t=>t===document.body?{width:window.innerWidth,height:window.innerHeight}:t.getBoundingClientRect())("string"==typeof t?n(t):t),r);return{p5Canvas:o.createCanvas(a*e.width,a*e.height,s),scaleFactor:a,logicalSize:e,drawScaled:t=>((t,e)=>{o.scale(e),t(),o.scale(1/e)})(t,a),logicalCenterPosition:{x:e.width/2,y:e.height/2}}};let l=!1;const h=(t,e,n)=>({x:t.x+n*Math.cos(e),y:t.y+n*Math.sin(e)});class d{constructor(t){this.factory=t,this.value=void 0}get(){return this.value||(this.value=this.factory())}clear(){return this.value=void 0,this}}const g=t=>new d(t),u=2*Math.PI,p=(t,e)=>Math.abs(t-e)<1e-13,m=(t,e)=>t+Math.random()*(e-t),w=t=>m(t.start,t.end),f=(t,e)=>((t,e,n)=>t+Math.pow(Math.random(),n)*(e-t))(t.start,t.end,e),y=t=>t[(t=>Math.floor(Math.random()*t))(t.length)],M=t=>Math.random()<t,C=t=>t*t,S=()=>{},x=t=>{t.count=0,t.progressRatio=0,t.isCompleted=!1},P=(t,e=S,n=S)=>({duration:t,progressRatioChangeRate:1/t,onProgress:e,onComplete:n,count:0,progressRatio:0,isCompleted:!1}),R=P(0),z=(t,e)=>{const n=Object.assign({},t);return n.onComplete=()=>{t.onComplete(n),e(n)},n},v=(t,e)=>{t.index=e,t.current=t.units[e]},I=(t,e=!1)=>{let n;const o=new Array(t.length),r=()=>(t=>v(t,t.index+1))(n),s=t.length-1;for(let e=0;e<s;e+=1)o[e]=z(t[e],r);return o[s]=e?z(t[s],()=>(t=>{((t,e)=>{const n=t.length;for(let o=0;o<n;o+=1)e(t[o],o,t)})(t.units,x),v(t,0)})(n)):t[s],n={units:o,current:o[0],index:0}},b=(I([R]),(t=>{const e=new Array(t),n=u/t;for(let o=0;o<t;o+=1)e[o]=o*n;return e})(8)),k={start:50,end:150},T={start:2,end:15},O={start:3,end:20},E={start:40,end:160},q=g(()=>["#7189bf","#df7599","#ffc785","#72d6c9","#202020"].map(t=>o.color(t))),F=g(()=>o.color("#202020")),H=(t,e)=>{const n=[];let o=e;for(;o<t;){const e=Math.min(t,o+f(T,3));n.push({color:y(q.get()),start:o,end:e}),o=e,o+=f(M(.8)?O:E,2)}return n},_=(t,e,n,r)=>{const s=t.length,a=10*(r?-1:1);for(let r=0;r<s;r+=1){const{color:s,start:i,end:c}=t[r];c<e||(n<i||(o.fill(s),o.rect(Math.max(e,i),0,Math.min(n,c),a)))}},A=t=>{const{x:e,y:n}=t.startPoint;i(t.graphics.draw,e,n,t.angle)},B=t=>(t=>{const{isCompleted:e,count:n,duration:o,progressRatioChangeRate:r}=t;if(!e){if(n>=o)return t.progressRatio=1,t.onProgress(t),t.isCompleted=!0,void t.onComplete(t);t.onProgress(t),t.count+=1,t.progressRatio+=r}})(t.timers.current),W=(t,e,n,s)=>{const i=(t=>{const e={start:0,end:0},n=t.length;return{data:t,trimRatio:e,draw:()=>{const r=e.start*n,s=e.end*n;_(t.leftSequence,r,s,!0),_(t.rightSequence,r,s,!1),o.stroke(F.get()),o.line(r,0,s,0),o.noStroke()}}})((t=>({length:t,leftSequence:H(t,0),rightSequence:H(t,w(k))}))(n)),{data:c,trimRatio:l}=i;let d;const g=Math.ceil(c.length/15),u=P(g,t=>{l.end=(t=>(t=>t*t*t)(t-1)+1)(t.progressRatio)},()=>{for(let o=0;o<1e3;o+=1){const o=h(t,e,n),i=y(b);if(e===i||p(Math.abs(e-i),Math.PI))continue;const c=m(20,600),l=h(o,i,c);if(a(r.logicalSize,l,80)){W(o,i,c,s);break}}}),f=P(30),M=P(g,t=>{l.start=C(t.progressRatio)},()=>{d.needsSweep=!0}),S=I([u,f,M]);return s(d={startPoint:t,angle:e,graphics:i,timers:S,onCreate:s,needsSweep:!1}),d};let D,L;const j=()=>{e(D,B),e(D,A),(t=>{const{array:e,size:n}=t;let o=0;for(let t=0;t<n;t+=1){const n=e[t];n.needsSweep||(e[o]=n,o+=1)}t.size=o})(D)},G=()=>{L(),r.drawScaled(j)},N=()=>{},X=()=>{switch(o.key){case"p":l?(o.loop(),l=!1):(o.noLoop(),l=!0);break;case"s":o.save("image.png")}};(e=>{const o=n(e.htmlElementId);new t(t=>{s(t),t.setup=()=>{(t=>{r=t})(c(o,e.logicalCanvasSize)),e.initialize()},e.setP5Methods(t)},o)})({htmlElementId:"LinesOfData",logicalCanvasSize:{width:800,height:800},initialize:()=>{const t=o.color(248,248,252);L=(t=>{o.pixels=t,o.updatePixels()}).bind(null,(t=>(o.push(),t(),o.pop(),o.loadPixels(),o.pixels))(()=>o.background(t))),o.noStroke(),o.strokeWeight(2),o.rectMode(o.CORNERS),D=(t=>({array:new Array(t),size:0}))(32),(()=>{(t=>{t.size=0})(D);const t=t=>((t,e)=>{t.array[t.size]=e,t.size+=1})(D,t);W({x:100,y:200},0,600,t),W({x:700,y:600},Math.PI,600,t)})()},setP5Methods:t=>{t.draw=G,t.mousePressed=N,t.keyTyped=X}})}(p5);