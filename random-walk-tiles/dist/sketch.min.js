/**
 * Random Walk Tiles.
 * Source code in TypeScript: https://github.com/fal-works/p5js-sketches/tree/master/random-walk-tiles
 *
 * @copyright 2020 FAL
 * @version 0.1.0
 */
!function(e,s){"use strict";const{Numeric:a,ArrayList:t,HSV:o,Random:r,Easing:n}=s,{onSetup:c,onInstantiate:l}=e;let i,d,g;l.push(e=>{i=e}),c.push(()=>{d=e.canvas,g=i.drawingContext});const u=n.concatenate(e=>a.square(e),e=>1-a.cube(e),.15),h=(e,s,t)=>({x:e,y:s,hue:t,rgb:o.toRGB([(t+r.Curved.signed(a.cube,150)+360)%360,.8,.98]).map(e=>255*e),progress:0,progressRate:.01}),p=e=>{const s=e.progress+e.progressRate;return s>=1||(e.progress=s,!1)},w=e=>{const{rgb:s}=e,a=192*u(e.progress),t=i.color(s[0],s[1],s[2],a);i.fill(t),g.shadowColor=`rgba(${s[0]}, ${s[1]}, ${s[2]}, ${.2*a})`,i.rect(e.x,e.y,28,28,4)},b=t.create(256),f=[];let k,R;const m=()=>{i.background(252),k=e.storePixels()},v=()=>{let e,s,a=0,o=0;const{width:n,height:c}=d.logicalSize,l=.1*n,i=.9*n,g=.1*c,u=.9*c;let p=!0;for(;p;){switch(r.Integer.value(4)){default:case 0:e=-1,s=0;break;case 1:e=0,s=-1;break;case 2:e=1,s=0;break;case 3:e=0,s=1}a=R.x+36*e,o=R.y+36*s,a>=l&&a<i&&o>=g&&o<u&&(p=!1)}const w=(R.hue+2)%360,k=h(a,o,w);(e=>{const s=Math.floor(e.x/36),a=Math.floor(e.y/36);null==f[s]&&(f[s]=[]);const o=f[s][a];null!=o&&(o.progressRate=.1),t.add(b,e),f[s][a]=e})(k),R=k},C=()=>{t.removeSwapAll(b,p);for(let e=0;e<2;e+=1)v()},S=()=>{t.loop(b,w)},y={draw:()=>{C(),k(),d.drawScaled(S)},keyTyped:()=>{switch(i.key){case"p":e.pauseOrResume();break;case"g":i.save("image.png");break;case"r":m()}return!1}};e.startSketch({htmlElement:"RandomWalkTiles",logicalCanvasHeight:1080,initialize:()=>{m(),i.noStroke(),i.rectMode(i.CENTER),i.blendMode(i.DARKEST),g.shadowOffsetX=6,g.shadowOffsetY=6,g.shadowBlur=16;const e=d.logicalSize,s=.5*e.width,a=.5*e.height;R=h(s,a,r.value(360))},windowResized:()=>d.resizeIfNeeded(),onCanvasResized:m,p5Methods:y})}(p5ex,CreativeCodingCore);