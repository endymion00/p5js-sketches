/**
 * CMYK.
 * Including module: p5ex (Copyright 2018 FAL, licensed under MIT).
 * Website => https://www.fal-works.com/
 * @copyright 2018 FAL
 * @author FAL <falworks.contact@gmail.com>
 * @version 0.1.0
 * @license CC-BY-SA-3.0
 */
!function(){"use strict";function t(t,e,s,i){return t&&void 0!==e?null===e?new l(t):s?new p(t,e,i):new h(t,e):new c}function e(t,e,s){return t+s*(e-t)}function s(t){return!(t.mouseX<0)&&(!(t.mouseX>t.width)&&(!(t.mouseY<0)&&!(t.mouseY>t.height)))}function i(t,s,i,o,n,r,a){!function(t,s,i,o,n,r,a,h=1){const l=t,c=a||l.pixelDensity();for(let p=0;p<c;p+=1)for(let t=0;t<c;t+=1){const a=4*((i*c+t)*l.width*c+(s*c+p));l.pixels[a]=e(l.pixels[a],o,h),l.pixels[a+1]=e(l.pixels[a+1],n,h),l.pixels[a+2]=e(l.pixels[a+2],r,h)}}(t,s,i,o,n,r,void 0,a/255)}class o{}class n extends o{get width(){return this.rightPositionX-this.leftPositionX}get height(){return this.bottomPositionY-this.topPositionY}get area(){return this.width*this.height}constructor(t,e,s,i,o=0){super(),this.leftPositionX=t-o,this.topPositionY=e-o,this.rightPositionX=s+o,this.bottomPositionY=i+o}contains(t,e=0){return t.x>=this.leftPositionX-e&&t.x<=this.rightPositionX+e&&t.y>=this.topPositionY-e&&t.y<=this.bottomPositionY+e}constrain(t,e=0){t.x<this.leftPositionX-e?t.x=this.leftPositionX-e:t.x>this.rightPositionX+e&&(t.x=this.rightPositionX+e),t.y<this.topPositionY-e?t.y=this.topPositionY-e:t.y>this.bottomPositionY+e&&(t.y=this.bottomPositionY+e)}}class r{constructor(t,e,s,i){this.p=t,this.canvasElement=t.createCanvas(e.scaledWidth,e.scaledHeight,i),this.canvasElement&&"parent"in this.canvasElement&&this.canvasElement.parent(s),this.region=new n(0,0,0,0),this.nonScaledShortSideLength=e.nonScaledShortSideLength,this.updateSize()}get scaleFactor(){return this._scaleFactor}get nonScaledWidth(){return this._nonScaledWidth}get nonScaledHeight(){return this._nonScaledHeight}get aspectRatio(){return this._aspectRatio}resize(t){this.p.resizeCanvas(t.scaledWidth,t.scaledHeight),this.nonScaledShortSideLength=t.nonScaledShortSideLength,this.updateSize()}updateSize(){const t=this.p;this._scaleFactor=Math.min(t.width,t.height)/this.nonScaledShortSideLength,this._inversedScaleFactor=1/this._scaleFactor,this._nonScaledWidth=t.width/this._scaleFactor,this._nonScaledHeight=t.height/this._scaleFactor,this._aspectRatio=t.width/t.height,this.region.rightPositionX=this._nonScaledWidth,this.region.bottomPositionY=this._nonScaledHeight}scale(){this.p.scale(this._scaleFactor)}cancelScale(){this.p.scale(this._inversedScaleFactor)}getNonScaledValueOf(t){return t/this._scaleFactor}}r.DUMMY_PARAMETERS={scaledWidth:100,scaledHeight:100,nonScaledShortSideLength:100};const a={SQUARE640x640:"SQUARE640x640",RECT640x480:"RECT640x480",FULL:"FULL",CUSTOM:"CUSTOM"};class h{constructor(t,e){this.p=t,this.p5Color=e}stroke(){this.p.currentRenderer.stroke(this.p5Color)}fill(){this.p.currentRenderer.fill(this.p5Color)}}class l{constructor(t){this.p=t}stroke(){this.p.currentRenderer.noStroke()}fill(){this.p.currentRenderer.noFill()}}class c{stroke(){}fill(){}}class p{constructor(t,e,s=256){this.p=t;const i=[];for(let o=0;o<s;o+=1)i.push(t.color(t.red(e),t.green(e),t.blue(e),t.alpha(e)*o/(s-1)));this.colorArray=i,this.maxIndex=s-1}stroke(t){this.p.currentRenderer.stroke(this.getColor(t))}fill(t){this.p.currentRenderer.fill(this.getColor(t))}getColor(t){return this.colorArray[t?Math.floor(this.p.map(t,0,255,0,this.maxIndex)):this.maxIndex]}}class u{constructor(e,s,i,o,n){this.strokeColor=t(e,s,o,n),this.fillColor=t(e,i,o,n)}applyColor(t){this.strokeColor.stroke(t),this.fillColor.fill(t)}}u.UNDEFINED=new u(void 0,void 0,void 0);const d=()=>{},g=(Math.PI,new p5(t=>{t.setup=(()=>{t.noCanvas()})}));Math.PI,g.createVector(),g.createVector();class f{constructor(t=0){this.value=t}valueOf(){return this.value}}f.NULL=new f;class m{constructor(t=256){this.array=new Array(t),this.length=0}get(t){return this.array[t]}getLast(){return this.array[this.length-1]}push(t){return this.array[this.length]=t,this.length+=1,this.length}pushRawArray(t,e=t.length){for(let s=0;s<e;s+=1)this.array[this.length+s]=t[s];return this.length+=e,this.length}pushAll(t){return this.pushRawArray(t.array,t.length)}pop(){return this.length-=1,this.array[this.length]}clear(){this.length=0}loop(t){!function(t,e,s){let i=0;for(;i<s;)e(t[i],i,t),i+=1}(this.array,t,this.length)}loopBackwards(t){!function(t,e,s){for(;s--;)e(t[s],s,t)}(this.array,t,this.length)}roundRobin(t){!function(t,e,s){for(let i=0,o=s-1;i<o;i+=1)for(let n=i+1;n<s;n+=1)e(t[i],t[n])}(this.array,t,this.length)}nestedLoopJoin(t,e){!function(t,e,s,i,o){for(let n=0;n<i;n+=1)for(let i=0;i<o;i+=1)s(t[n],e[i])}(this.array,t.array,e,this.length,t.length)}}class R extends m{static drawFunction(t){t.draw()}draw(){this.loop(R.drawFunction)}}class C extends m{static stepFunction(t){t.step()}step(){this.loop(C.stepFunction)}}class y extends m{}y.prototype.step=C.prototype.step,y.prototype.draw=R.prototype.draw;class S extends m{constructor(t){super(t),this.recentRemovedElements=new m(t)}clean(){this.recentRemovedElements.clear();let t=0;for(let e=0;e<this.length;e+=1)this.array[e].clean(),this.array[e].isToBeRemoved?this.recentRemovedElements.push(this.array[e]):(this.array[t]=this.array[e],t+=1);this.length=t}}class x extends S{}x.prototype.draw=y.prototype.draw,x.prototype.step=y.prototype.step;class v{constructor(t,e=1){this.p=t,this.internalValue=e,this.internalReciprocalValue=1/e}get value(){return this.internalValue}set value(t){if(0===t)return this.internalValue=1e-4,void(this.internalReciprocalValue=1e4);this.internalValue=t,this.internalReciprocalValue=1/t}get reciprocalValue(){return this.internalReciprocalValue}applyScale(){this.p.currentRenderer.scale(this.internalValue)}cancel(){this.p.currentRenderer.scale(this.internalReciprocalValue)}}class w{constructor(t,e,s){this.p=t,this.set(e,s)}set(t,e){this.element=t,this.position=e.positionRef||this.p.createVector(),this.offsetPosition=e.offsetPositionRef||this.p.createVector(),this.rotation=e.rotationAngleRef||f.NULL,this.scaleFactor=e.scaleFactorRef||new v(this.p),this.shapeColor=e.shapeColorRef||u.UNDEFINED,this.alphaChannel=e.alphaChannelRef||f.NULL,this.strokeWeight=e.strokeWeightRef||f.NULL,this.textSize=e.textSizeRef||f.NULL,this.procedureList=this.createProcedureList(e),this.procedureListLength=this.procedureList.length}draw(){for(let t=0,e=this.procedureListLength;t<e;t+=1)this.procedureList[t](this)}drawElement(t){t.element.draw()}createProcedureList(t){const e=[];return t.shapeColorRef&&(t.alphaChannelRef?e.push(this.alphaColor):e.push(this.color)),t.textSizeRef&&e.push(this.applyTextSize),t.strokeWeightRef&&e.push(this.applyStrokeWeight),t.positionRef?t.offsetPositionRef?e.push(this.translateWithOffset):e.push(this.translate):t.offsetPositionRef&&e.push(this.translateOnlyOffset),t.scaleFactorRef&&e.push(this.scale),t.rotationAngleRef&&e.push(this.rotate),e.push(this.drawElement),t.rotationAngleRef&&e.push(this.cancelRotate),t.scaleFactorRef&&e.push(this.cancelScale),t.positionRef?t.offsetPositionRef?e.push(this.cancelTranslateWithOffset):e.push(this.cancelTranslate):t.offsetPositionRef&&e.push(this.cancelTranslateOnlyOffset),e}translate(t){t.p.currentRenderer.translate(t.position.x,t.position.y)}cancelTranslate(t){t.p.currentRenderer.translate(-t.position.x,-t.position.y)}translateOnlyOffset(t){t.p.currentRenderer.translate(t.offsetPosition.x,t.offsetPosition.y)}cancelTranslateOnlyOffset(t){t.p.currentRenderer.translate(-t.offsetPosition.x,-t.offsetPosition.y)}translateWithOffset(t){t.p.currentRenderer.translate(t.position.x+t.offsetPosition.x,t.position.y+t.offsetPosition.y)}cancelTranslateWithOffset(t){t.p.currentRenderer.translate(-(t.position.x+t.offsetPosition.x),-(t.position.y+t.offsetPosition.y))}rotate(t){t.p.currentRenderer.rotate(t.rotation.value)}cancelRotate(t){t.p.currentRenderer.rotate(-t.rotation.value)}scale(t){1!==t.scaleFactor.value&&t.scaleFactor.applyScale()}cancelScale(t){1!==t.scaleFactor.value&&t.scaleFactor.cancel()}color(t){t.shapeColor.applyColor()}alphaColor(t){t.shapeColor.applyColor(t.alphaChannel.value)}applyStrokeWeight(t){t.p.currentRenderer.strokeWeight(t.strokeWeight.value)}applyTextSize(t){t.p.currentRenderer.textSize(t.textSize.value)}}g.createVector(),g.createVector();class P{static get NULL(){return b}constructor(t=0,e=0){this.angleReference=new f(t),this.angleVelocityReference=new f(e)}get angle(){return this.angleReference.value}set angle(t){this.angleReference.value=t}get angleVelocity(){return this.angleVelocityReference.value}set angleVelocity(t){this.angleVelocityReference.value=t}step(){this.angle+=this.angleVelocity}}const b=new class extends P{get angle(){return 0}set angle(t){}get angleVelocity(){return 0}set angleVelocity(t){}step(){}};g.createVector();class _{constructor(){this.count=0}resetCount(t=0){return this.count=t,this}step(){this.count+=1}mod(t){return this.count%t}}class F extends _{get isOn(){return this._isOn}constructor(t,e=d){super(),this._isOn=!0,this.completeBehavior=e,this.durationFrameCount=t}on(t){return this._isOn=!0,t&&(this.durationFrameCount=t),this}off(){return this._isOn=!1,this}step(){this._isOn&&(this.count+=1,this.count>this.durationFrameCount&&this.completeCycle())}}class L extends F{get isCompleted(){return this._isCompleted}constructor(t,e){super(t,e),this._isCompleted=!1}on(t){return super.on(t),this}off(){return super.off(),this}resetCount(){return super.resetCount(),this._isCompleted=!1,this}getProgressRatio(){return this._isCompleted?1:this.count/this.durationFrameCount}completeCycle(){this._isCompleted=!0,this._isOn=!1,this.completeBehavior()}}class A{constructor(t,e,s){this.p=t,this.position=e,this.velocity=s,this.isToBeRemoved=!1,this.isActive=!0,this.remainingBoundCount=1,this.postBirthTimer=new L(30),s.magSq()<1.1*1.1&&s.set(p5.Vector.random2D().mult(1.1))}step(){if(!this.isActive)return;this.postBirthTimer.step();const t=this.velocity.magSq();t>8?this.velocity.mult(.95):t<2&&this.velocity.mult(1.1),this.position.add(this.velocity)}clean(){if(this.remainingBoundCount>0)return(this.position.x<0||this.position.x>this.p.nonScaledWidth)&&(this.p.constrain(this.position.x,0,this.p.nonScaledWidth),this.velocity.x*=-1,this.remainingBoundCount-=1),void((this.position.y<0||this.position.y>this.p.nonScaledHeight)&&(this.p.constrain(this.position.y,0,this.p.nonScaledHeight),this.velocity.y*=-1,this.remainingBoundCount-=1));const t=this.size;(this.position.x<-t||this.position.x>this.p.nonScaledWidth+t||this.position.y<-t||this.position.y>this.p.nonScaledHeight+t)&&(this.isToBeRemoved=!0)}draw(){}hasColor(t){return!0}hasCommonColor(t){return!0}setSize(t){}}class V extends A{constructor(t,e,s){super(t,t.createVector(t.scalableCanvas.getNonScaledValueOf(t.mouseX),t.scalableCanvas.getNonScaledValueOf(t.mouseY)),s),this.p=t,this.color=e,this.rotation=new P(t.random(t.TWO_PI),.01*t.random(-1,1)*t.TWO_PI),this.size=12,this.drawer=new w(t,{draw:()=>{t.rect(-.4*this.size,-.4*this.size,this.size,this.size)}},{shapeColorRef:e,rotationAngleRef:this.rotation.angleReference})}step(){super.step(),this.rotation.step()}draw(){this.isActive&&this.p.translate(this.position.x,this.position.y),this.drawer.draw(),this.isActive&&this.p.translate(-this.position.x,-this.position.y)}hasColor(t){return this.color===t}hasCommonColor(t){return t.hasColor(this.color)}setSize(t){this.size=t}}class T extends A{constructor(t,e,s){super(t,p5.Vector.add(e.position,s.position).mult(.5),p5.Vector.add(e.velocity,s.velocity).mult(.5)),this.objectA=e,this.objectB=s,e.position.set(0,0),s.position.set(0,0),e.isActive=!1,s.isActive=!1,this.setSize(1.2*Math.max(e.size,s.size))}step(){super.step(),this.objectA.step(),this.objectB.step()}draw(){if(this.p.translate(this.position.x,this.position.y),this.objectA.draw(),this.objectB.draw(),!this.postBirthTimer.isCompleted){const t=this.postBirthTimer.getProgressRatio();if(t<1){T.effectColor.applyColor(255*(1-t));const e=60*function(t){return 1-Math.pow(t-1,4)}(t);this.p.strokeWeight(4*(1-t)),this.p.ellipse(0,0,e,e)}}this.p.translate(-this.position.x,-this.position.y)}hasColor(t){return this.objectA.hasColor(t)||this.objectB.hasColor(t)}hasCommonColor(t){return this.objectA.hasCommonColor(t)||this.objectB.hasCommonColor(t)}setSize(t){this.size=t,this.objectA.setSize(t),this.objectB.setSize(t)}}new class extends p5{setCurrentRenderer(t){this.currentRenderer=t}get nonScaledWidth(){return this.scalableCanvas.nonScaledWidth}get nonScaledHeight(){return this.scalableCanvas.nonScaledHeight}get idealFrameRate(){return this._idealFrameRate}get unitAngleSpeed(){return this._unitAngleSpeed}get unitSpeed(){return this._unitSpeed}get unitAccelerationMagnitude(){return this._unitAccelerationMagnitude}constructor(t,e,s){super(t,"string"==typeof e?document.getElementById(e)||void 0:e,s),this.node=e&&"boolean"!=typeof e?"string"==typeof e?document.getElementById(e)||document.body:e:document.body,this.currentRenderer=this,this.maxCanvasRegion={width:0,height:0,getShortSideLength(){return Math.min(this.width,this.height)}},this.updateMaxCanvasRegion(),this.setFrameRate()}setFrameRate(t=60){return this.frameRate(t),t&&(this._idealFrameRate=t,this._unitAngleSpeed=2*Math.PI/this._idealFrameRate,this._unitSpeed=1/this._idealFrameRate,this._unitAccelerationMagnitude=this._unitSpeed/this._idealFrameRate),this}updateMaxCanvasRegion(){if(this.maxCanvasRegion.width=this.windowWidth,this.maxCanvasRegion.height=this.windowHeight,this.node===document.body)return;const t=this.node.getBoundingClientRect();this.maxCanvasRegion.width=t.width,this.maxCanvasRegion.height=t.height}createScalableCanvas(t,e,s){this.scalableCanvasType=t,this.scalableCanvas=new r(this,this.createScalableCanvasParameter(t,e),this.node,s)}resizeScalableCanvas(t,e){this.scalableCanvas.resize(this.createScalableCanvasParameter(t||this.scalableCanvasType,e))}createScalableCanvasParameter(t,e){this.updateMaxCanvasRegion();const s=this.maxCanvasRegion.getShortSideLength();switch(t){case a.SQUARE640x640:return{scaledWidth:s,scaledHeight:s,nonScaledShortSideLength:640};case a.RECT640x480:return{scaledWidth:s,scaledHeight:.75*s,nonScaledShortSideLength:480};case a.FULL:return{scaledWidth:this.maxCanvasRegion.width,scaledHeight:this.maxCanvasRegion.height,nonScaledShortSideLength:640};default:return e||r.DUMMY_PARAMETERS}}}(t=>{function e(){t.blendMode(t.BLEND),t.background(n),function(t,e,s=!0,o=0,n=0,r=0){const a=t,h=a.width,l=a.height,c=s?i:function(t,e,s,i,o,n,r,a){const h=t,l=a||h.pixelDensity();for(let c=0;c<l;c+=1)for(let t=0;t<l;t+=1){const a=4*((s*l+t)*h.width*l+(e*l+c));h.pixels[a]=i,h.pixels[a+1]=o,h.pixels[a+2]=n,h.pixels[a+3]=r}};a.loadPixels();for(let i=0;i<l;i+=1)for(let s=0;s<h;s+=1)c(t,s,i,o,n,r,Math.random()*e);a.updatePixels()}(t,8,!0,0,0,32),t.loadPixels(),r=t.pixels,t.blendMode(t.DIFFERENCE)}function o(e){l.push(new V(t,c[f],p5.Vector.fromAngle(e).mult(8)))}let n,r,h,l,c,p,d,g=-1,f=0;t.preload=(()=>{}),t.setup=(()=>{t.createScalableCanvas(a.SQUARE640x640),n=t.color(255,255,255),h=new x,l=new y,c=[new u(t,null,t.color(255,0,0)),new u(t,null,t.color(0,255,0)),new u(t,null,t.color(0,0,255))],T.effectColor=new u(t,t.color(255,255,255),null,!0),p=t.color(160,160,160),d=t.createVector(.5*t.nonScaledWidth,.5*t.nonScaledHeight),e()}),t.draw=(()=>{if(t.pixels=r,t.updatePixels(),d.set(t.scalableCanvas.getNonScaledValueOf(t.mouseX),t.scalableCanvas.getNonScaledValueOf(t.mouseY)),t.scalableCanvas.scale(),h.step(),h.clean(),h.draw(),t.stroke(p),t.strokeWeight(3),t.line(d.x-10,d.y,d.x+10,d.y),t.line(d.x,d.y-10,d.x,d.y+10),t.scalableCanvas.cancelScale(),h.roundRobin((e,s)=>{e.postBirthTimer.isCompleted&&s.postBirthTimer.isCompleted&&!e.isToBeRemoved&&!s.isToBeRemoved&&!e.hasCommonColor(s)&&Math.abs(e.position.x-s.position.x)<10&&Math.abs(e.position.y-s.position.y)<10&&(e.isToBeRemoved=!0,s.isToBeRemoved=!0,l.push(new T(t,e,s)))}),s(t)&&t.mouseIsPressed&&t.frameCount%2==0){const e=t.TWO_PI*(t.frameCount%31/31);o(e),o(e+t.PI)}h.pushAll(l),l.clear()}),t.windowResized=(()=>{-1!==g&&clearTimeout(g),g=setTimeout(()=>{t.resizeScalableCanvas(),e()},200)}),t.mousePressed=(()=>{if(s(t))return!1}),t.mouseReleased=(()=>{f=(f+1)%c.length}),t.keyTyped=(()=>{})},"CMYK")}();