{"version":3,"file":"sketch.js","sources":["../src/common/environment.ts","../src/common/array.ts","../src/common/boundingBox.ts","../src/p5util/transform.ts","../src/p5util/canvas.ts","../src/p5util/drawing.ts","../src/common/timer.ts","../src/common/easing.ts","../src/main.ts"],"sourcesContent":["/**\r\n * ---- Common environment utility -------------------------------------------\r\n */\r\n\r\nimport { RectangleSize } from \"./dataTypes\";\r\n\r\n/**\r\n * Finds HTML element by `id`. If not found, returns `document.body`.\r\n * @param id\r\n */\r\nexport const getElementOrBody = (id: string): HTMLElement =>\r\n  document.getElementById(id) || document.body;\r\n\r\n/**\r\n * Returns the width and height of `node`.\r\n * If `node === document.body`, returns the inner width and height of `window`.\r\n * @param node\r\n */\r\nexport const getElementSize = (node: Element): RectangleSize =>\r\n  node === document.body\r\n    ? {\r\n        width: window.innerWidth,\r\n        height: window.innerHeight\r\n      }\r\n    : node.getBoundingClientRect();\r\n","/**\r\n * ---- Common array utility -------------------------------------------------\r\n */\r\n\r\nimport { ArrayOrValue } from \"./dataTypes\";\r\n\r\nexport function loopLimited<T>(\r\n  array: T[],\r\n  callback: (currentValue: T, index?: number, array?: T[]) => any,\r\n  arrayLength: number\r\n) {\r\n  for (let i = 0; i < arrayLength; i += 1) {\r\n    callback(array[i], i, array);\r\n  }\r\n}\r\n\r\n/**\r\n * Runs `callback` once for each element of `array`.\r\n * Unlike `forEach()`, an element of `array` should not be removed during the iteration.\r\n * @param array\r\n * @param callback\r\n */\r\nexport function loop<T>(\r\n  array: T[],\r\n  callback: (currentValue: T, index?: number, array?: T[]) => any\r\n): void {\r\n  const arrayLength = array.length;\r\n\r\n  for (let i = 0; i < arrayLength; i += 1) {\r\n    callback(array[i], i, array);\r\n  }\r\n}\r\n\r\nexport function loopBackwardsLimited<T>(\r\n  array: T[],\r\n  callback: (currentValue: T, index?: number, array?: T[]) => any,\r\n  arrayLength: number\r\n): void {\r\n  if (arrayLength < 0)\r\n    throw new RangeError(`arrayLength ${arrayLength} is invalid.`);\r\n\r\n  while (arrayLength--) {\r\n    callback(array[arrayLength], arrayLength, array);\r\n  }\r\n}\r\n\r\n/**\r\n * Runs `callback` once for each element of `array` in descending order.\r\n * @param array\r\n * @param callback\r\n */\r\nexport function loopBackwards<T>(\r\n  array: T[],\r\n  callback: (currentValue: T, index?: number, array?: T[]) => any\r\n): void {\r\n  let arrayLength = array.length;\r\n\r\n  while (arrayLength--) {\r\n    callback(array[arrayLength], arrayLength, array);\r\n  }\r\n}\r\n\r\nexport function nestedLoopJoinLimited<T, U>(\r\n  array: T[],\r\n  otherArray: U[],\r\n  callback: (element: T, otherElement: U) => any,\r\n  arrayLength: number,\r\n  otherArrayLength: number\r\n): void {\r\n  for (let i = 0; i < arrayLength; i += 1) {\r\n    for (let k = 0; k < otherArrayLength; k += 1) {\r\n      callback(array[i], otherArray[k]);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Joins two arrays and runs `callback` once for each joined pair.\r\n * @param array\r\n * @param otherArray\r\n * @param callback\r\n */\r\nexport function nestedLoopJoin<T, U>(\r\n  array: T[],\r\n  otherArray: U[],\r\n  callback: (element: T, otherElement: U) => any\r\n): void {\r\n  nestedLoopJoinLimited(\r\n    array,\r\n    otherArray,\r\n    callback,\r\n    array.length,\r\n    otherArray.length\r\n  );\r\n}\r\n\r\nexport function roundRobinLimited<T>(\r\n  array: T[],\r\n  callback: (element: T, otherElement: T) => any,\r\n  arrayLength: number\r\n): void {\r\n  const iLen = arrayLength - 1;\r\n  for (let i = 0; i < iLen; i += 1) {\r\n    for (let k = i + 1; k < arrayLength; k += 1) {\r\n      callback(array[i], array[k]);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Runs `callback` once for each pair within `array`.\r\n * @param array\r\n * @param callback\r\n */\r\nexport function roundRobin<T>(\r\n  array: T[],\r\n  callback: (element: T, otherElement: T) => any\r\n): void {\r\n  roundRobinLimited(array, callback, array.length);\r\n}\r\n\r\n/**\r\n * Creates a new 1-dimensional array by concatenating sub-array elements of a 2-dimensional array.\r\n * @param arrays\r\n * @return A new 1-dimensional array.\r\n */\r\nexport const flatNaive = <T>(arrays: T[][]): T[] => [].concat.apply([], arrays);\r\n\r\n/**\r\n * An alternative to `Array.prototype.flat()`.\r\n * @param array\r\n * @param depth\r\n * @return A new array.\r\n */\r\nexport const flatRecursive = <T>(array: ArrayOrValue<T>[], depth: number = 1) =>\r\n  depth > 0\r\n    ? array.reduce(\r\n        (acc: ArrayOrValue<T>[], cur): ArrayOrValue<T>[] =>\r\n          acc.concat(Array.isArray(cur) ? flatRecursive(cur, depth - 1) : cur),\r\n        []\r\n      )\r\n    : array;\r\n","/**\r\n * ---- Common bounding box utility ------------------------------------------\r\n */\r\n\r\nimport { RectangleSize } from \"./dataTypes\";\r\n\r\n/**\r\n * Calculates the aspect ratio i.e. `width / height`.\r\n * @param size\r\n */\r\nexport const getAspectRatio = (size: RectangleSize) => size.width / size.height;\r\n\r\n/**\r\n * Calculates the area i.e. `width * height`.\r\n * @param size\r\n */\r\nexport const getArea = (size: RectangleSize) => size.width * size.height;\r\n\r\n/**\r\n * Parameter for `getScaleFactor()`.\r\n * `FIT_TO_BOX` checks both width and height and returns the smaller scale factor.\r\n */\r\nexport const enum FittingOption {\r\n  FIT_TO_BOX = \"FIT_TO_BOX\",\r\n  FIT_WIDTH = \"FIT_WIDTH\",\r\n  FIT_HEIGHT = \"FIT_HEIGHT\"\r\n}\r\n\r\n/**\r\n * Calculates the scale factor for fitting `nonScaledSize` to `targetSize` keeping the original aspect ratio.\r\n *\r\n * @param nonScaledSize\r\n * @param targetSize\r\n * @param fittingOption\r\n */\r\nexport const getScaleFactor = (\r\n  nonScaledSize: RectangleSize,\r\n  targetSize: RectangleSize,\r\n  fittingOption?: FittingOption\r\n) => {\r\n  switch (fittingOption) {\r\n    default:\r\n    case FittingOption.FIT_TO_BOX:\r\n      return Math.min(\r\n        targetSize.width / nonScaledSize.width,\r\n        targetSize.height / nonScaledSize.height\r\n      );\r\n\r\n    case FittingOption.FIT_WIDTH:\r\n      return targetSize.width / nonScaledSize.width;\r\n\r\n    case FittingOption.FIT_HEIGHT:\r\n      return targetSize.height / nonScaledSize.height;\r\n  }\r\n};\r\n","/**\r\n * ---- p5.js transformation utility -----------------------------------------\r\n */\r\n\r\n0; // dummy code for VSCode to ignore file header\r\n\r\n/**\r\n * Runs `drawCallback` translated with `offsetX` and `offsetY`,\r\n * then restores the transformation by calling `p.translate()` with negative values.\r\n * Used to avoid calling `p.push()` and `p.pop()` frequently.\r\n *\r\n * @param p\r\n * @param drawCallback\r\n * @param offsetX\r\n * @param offsetY\r\n */\r\nexport function drawTranslated(\r\n  p: p5,\r\n  drawCallback: (p: p5) => any,\r\n  offsetX: number,\r\n  offsetY: number\r\n): void {\r\n  p.translate(offsetX, offsetY);\r\n  drawCallback(p);\r\n  p.translate(-offsetX, -offsetY);\r\n}\r\n\r\n/**\r\n * Runs `drawCallback` rotated with `angle`,\r\n * then restores the transformation by calling `p.rotate()` with the negative value.\r\n * Used to avoid calling `p.push()` and `p.pop()` frequently.\r\n *\r\n * @param p\r\n * @param drawCallback\r\n * @param angle\r\n */\r\nexport function drawRotated(\r\n  p: p5,\r\n  drawCallback: (p: p5) => any,\r\n  angle: number\r\n): void {\r\n  p.rotate(angle);\r\n  drawCallback(p);\r\n  p.rotate(-angle);\r\n}\r\n\r\n/**\r\n * Composite of `drawTranslated()` and `drawRotated()`.\r\n *\r\n * @param p\r\n * @param drawCallback\r\n * @param offsetX\r\n * @param offsetY\r\n * @param angle\r\n */\r\nexport function drawTranslatedAndRotated(\r\n  p: p5,\r\n  drawCallback: (p: p5) => any,\r\n  offsetX: number,\r\n  offsetY: number,\r\n  angle: number\r\n): void {\r\n  p.translate(offsetX, offsetY);\r\n  drawRotated(p, drawCallback, angle);\r\n  p.translate(-offsetX, -offsetY);\r\n}\r\n\r\n/**\r\n * Runs `drawCallback` scaled with `scaleFactor`,\r\n * then restores the transformation by scaling with the inversed factor.\r\n * Used to avoid calling `p.push()` and `p.pop()` frequently.\r\n *\r\n * @param p\r\n * @param drawCallback\r\n * @param scaleFactor\r\n */\r\nexport function drawScaled(\r\n  p: p5,\r\n  drawCallback: (p: p5) => any,\r\n  scaleFactor: number\r\n): void {\r\n  p.scale(scaleFactor);\r\n  drawCallback(p);\r\n  p.scale(1 / scaleFactor);\r\n}\r\n","/**\r\n * ---- p5.js canvas utility -------------------------------------------------\r\n */\r\n\r\nimport { RectangleSize } from \"../common/dataTypes\";\r\nimport { FittingOption, getScaleFactor } from \"../common/boundingBox\";\r\nimport { getElementOrBody, getElementSize } from \"../common/environment\";\r\nimport { drawScaled } from \"./transform\";\r\n\r\n/**\r\n * p5.js canvas accompanied by a scale factor.\r\n */\r\nexport interface ScaledCanvas {\r\n  readonly p5Canvas: p5.Renderer;\r\n  readonly scaleFactor: number;\r\n  readonly nonScaledSize: RectangleSize;\r\n  readonly drawScaled: (drawCallback: (p: p5) => void) => void;\r\n}\r\n\r\n/**\r\n * Runs `p.createCanvas()` with the scaled size that fits to `node`.\r\n * Returns the created canvas and the scale factor.\r\n *\r\n * @param p - The p5 instance.\r\n * @param node - The HTML element or its ID.\r\n * @param nonScaledSize\r\n * @param fittingOption\r\n * @param renderer\r\n */\r\nexport function createScaledCanvas(\r\n  p: p5,\r\n  node: HTMLElement | string,\r\n  nonScaledSize: RectangleSize,\r\n  fittingOption?: FittingOption,\r\n  renderer?: \"p2d\" | \"webgl\" | undefined\r\n): ScaledCanvas {\r\n  const maxCanvasSize = getElementSize(\r\n    typeof node === \"string\" ? getElementOrBody(node) : node\r\n  );\r\n  const scaleFactor = getScaleFactor(\r\n    nonScaledSize,\r\n    maxCanvasSize,\r\n    fittingOption\r\n  );\r\n\r\n  const canvas = p.createCanvas(\r\n    scaleFactor * nonScaledSize.width,\r\n    scaleFactor * nonScaledSize.height,\r\n    renderer\r\n  );\r\n\r\n  return {\r\n    p5Canvas: canvas,\r\n    scaleFactor: scaleFactor,\r\n    nonScaledSize: nonScaledSize,\r\n    drawScaled: (drawCallback: (p: p5) => void) =>\r\n      drawScaled(p, drawCallback, scaleFactor)\r\n  };\r\n}\r\n","/**\r\n * ---- p5.js drawing utility ------------------------------------------------\r\n */\r\n\r\n0; // dummy code for VSCode to ignore file header\r\n\r\n/**\r\n * Sets color to the specified pixel.\r\n * Should be used in conjunction with loadPixels() and updatePixels().\r\n * @param renderer - Instance of either p5 or p5.Graphics.\r\n * @param x - The x index of the pixel.\r\n * @param y - The y index of the pixel.\r\n * @param red - The red value (0 - 255).\r\n * @param green - The green value (0 - 255).\r\n * @param blue - The blue value (0 - 255).\r\n * @param pixelDensity - If not specified, renderer.pixelDensity() will be called.\r\n */\r\nexport function setPixel(\r\n  renderer: p5 | p5.Graphics,\r\n  x: number,\r\n  y: number,\r\n  red: number,\r\n  green: number,\r\n  blue: number,\r\n  alpha: number,\r\n  pixelDensity?: number\r\n): void {\r\n  const g = renderer as p5;\r\n  const d = pixelDensity || g.pixelDensity();\r\n  const graphicsPixels = g.pixels;\r\n\r\n  for (let i = 0; i < d; i += 1) {\r\n    for (let j = 0; j < d; j += 1) {\r\n      const idx = 4 * ((y * d + j) * g.width * d + (x * d + i));\r\n      graphicsPixels[idx] = red;\r\n      graphicsPixels[idx + 1] = green;\r\n      graphicsPixels[idx + 2] = blue;\r\n      graphicsPixels[idx + 3] = alpha;\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Runs `drawCallback` and `p.loadPixels()`, then returns `p.pixels`.\r\n * The style and transformations will be restored by using `p.push()` and `p.pop()`.\r\n * @param p The p5 instance.\r\n * @param drawCallback\r\n */\r\nexport function createPixels(p: p5, drawCallback: (p: p5) => any): number[] {\r\n  p.push();\r\n  drawCallback(p);\r\n  p.pop();\r\n  p.loadPixels();\r\n\r\n  return p.pixels;\r\n}\r\n","/**\r\n * ---- Common random utility ------------------------------------------------\r\n */\r\n\r\n0;\r\n\r\nexport interface Timer {\r\n  step: () => void;\r\n  isCompleted: () => boolean;\r\n  reset: () => void;\r\n  getProgressRatio: () => number;\r\n  getCount: () => number;\r\n}\r\n\r\nexport const createTimer = (duration: number): Timer => {\r\n  let count = 0;\r\n\r\n  const step = () => {\r\n    count += 1;\r\n  };\r\n  const isCompleted = () => count === duration;\r\n  const reset = () => {\r\n    count = 0;\r\n  };\r\n  const getProgressRatio = () => count / duration;\r\n  const getCount = () => count;\r\n\r\n  return {\r\n    step,\r\n    isCompleted,\r\n    reset,\r\n    getProgressRatio,\r\n    getCount\r\n  };\r\n};\r\n\r\nexport interface TimerCallback {\r\n  (timer: Timer): void;\r\n}\r\n\r\nexport interface Phase {\r\n  duration: number;\r\n  callback: TimerCallback;\r\n}\r\n\r\nexport interface TimerChain {\r\n  step: () => void;\r\n  runPhase: () => void;\r\n}\r\n\r\nexport const createTimerChain = (\r\n  phases: Phase[],\r\n  loopCallback: () => void = () => {}\r\n): TimerChain => {\r\n  let phaseIndex = 0;\r\n  let currentCallback = phases[0].callback;\r\n  const phaseLength = phases.length;\r\n  const timers: Timer[] = [];\r\n  const callbacks: TimerCallback[] = [];\r\n  for (let i = 0, len = phases.length; i < len; i += 1) {\r\n    timers.push(createTimer(phases[i].duration));\r\n    callbacks.push(phases[i].callback);\r\n  }\r\n  let currentTimer = timers[0];\r\n\r\n  const step = () => {\r\n    currentTimer.step();\r\n\r\n    if (currentTimer.isCompleted()) {\r\n      currentTimer.reset();\r\n      phaseIndex += 1;\r\n\r\n      if (phaseIndex >= phaseLength) {\r\n        phaseIndex = 0;\r\n        loopCallback();\r\n      }\r\n\r\n      currentTimer = timers[phaseIndex];\r\n      currentCallback = phases[phaseIndex].callback;\r\n    }\r\n  };\r\n\r\n  const runPhase = () => {\r\n    currentCallback(currentTimer);\r\n  };\r\n\r\n  return {\r\n    step,\r\n    runPhase\r\n  };\r\n};\r\n","/**\r\n * ---- Common random utility ------------------------------------------------\r\n */\r\n\r\n0;\r\n\r\n/**\r\n * Linear easing function.\r\n * @param ratio\r\n */\r\nexport function easeLinear(ratio: number) {\r\n  return ratio;\r\n}\r\n\r\n/**\r\n * easeOutQuad.\r\n * @param ratio\r\n */\r\nexport function easeOutQuad(ratio: number) {\r\n  return -Math.pow(ratio - 1, 2) + 1;\r\n}\r\n\r\n/**\r\n * easeOutCubic.\r\n * @param ratio\r\n */\r\nexport function easeOutCubic(ratio: number) {\r\n  return Math.pow(ratio - 1, 3) + 1;\r\n}\r\n\r\n/**\r\n * easeOutQuart.\r\n * @param ratio\r\n */\r\nexport function easeOutQuart(ratio: number) {\r\n  return -Math.pow(ratio - 1, 4) + 1;\r\n}\r\n\r\nconst EASE_OUT_BACK_DEFAULT_COEFFICIENT = 1.70158;\r\n\r\n/**\r\n * easeOutBack.\r\n * @param ratio\r\n */\r\nexport function easeOutBack(ratio: number) {\r\n  const r = ratio - 1;\r\n\r\n  return (\r\n    (EASE_OUT_BACK_DEFAULT_COEFFICIENT + 1) * Math.pow(r, 3) +\r\n    EASE_OUT_BACK_DEFAULT_COEFFICIENT * Math.pow(r, 2) +\r\n    1\r\n  );\r\n}\r\n\r\n/**\r\n * Easing function.\r\n */\r\nexport interface Easing {\r\n  (ratio: number): number;\r\n}\r\n\r\n/**\r\n * Returns an easeOut function.\r\n * @param exponent - Integer from 1 to 4.\r\n */\r\nexport function getEasingFunction(exponent: number): Easing {\r\n  switch (Math.floor(exponent)) {\r\n    default:\r\n    case 1:\r\n      return easeLinear;\r\n    case 2:\r\n      return easeOutQuad;\r\n    case 3:\r\n      return easeOutCubic;\r\n    case 4:\r\n      return easeOutQuart;\r\n  }\r\n}\r\n","/**\r\n * ---- Main sketch ----------------------------------------------------------\r\n */\r\n\r\nimport { getElementOrBody } from \"./common/environment\";\r\n// import * as random from \"./common/random\";\r\nimport { loop } from \"./common/array\";\r\n\r\nimport { createScaledCanvas, ScaledCanvas } from \"./p5util/canvas\";\r\n// import { createApplyColor, ApplyColorFunction } from \"./p5util/color\";\r\nimport { createPixels } from \"./p5util/drawing\";\r\n// import { drawTranslated, drawTranslatedAndRotated } from \"./p5util/transform\";\r\n\r\nimport { createTimerChain, Timer } from \"./common/timer\";\r\nimport { easeOutQuad, easeOutQuart } from \"./common/easing\";\r\n\r\nconst HTML_ELEMENT = getElementOrBody(\"Dots\");\r\n\r\ninterface Sprite {\r\n  step: () => void;\r\n  draw: () => void;\r\n}\r\n\r\ninterface Dot extends Sprite {\r\n  setFactor: (factor: number) => void;\r\n}\r\n\r\nconst sketch = (p: p5): void => {\r\n  // ---- variables\r\n  const GRAPHICS_FRAME_LENGTH = 128;\r\n  let canvas: ScaledCanvas;\r\n  let backgroundPixels: number[];\r\n  let backgroundColor: p5.Color;\r\n  let graphicsFrames: p5.Graphics[];\r\n  let dots: Sprite[];\r\n\r\n  // ---- functions\r\n  const createDot = (x: number, y: number): Dot => {\r\n    let factor = 1;\r\n    let active = true;\r\n    let noiseTime = 0;\r\n    const lastFrameIndex = graphicsFrames.length - 1;\r\n    const loopCallback = () => {\r\n      noiseTime += 1;\r\n      factor = (p.noise(0.01 * x, 0.01 * y, noiseTime) - 0.5) * 2;\r\n      factor = Math.min(factor + p.random(-0.3, 0.3), 1);\r\n      active = factor > 0;\r\n    };\r\n    loopCallback();\r\n    const timerChain = createTimerChain(\r\n      [\r\n        {\r\n          duration: 15,\r\n          callback: (timer: Timer) => {\r\n            if (!active) return;\r\n            const frameIndex =\r\n              (factor * timer.getProgressRatio() * lastFrameIndex) | 0;\r\n            p.image(graphicsFrames[frameIndex], x, y);\r\n          }\r\n        },\r\n        {\r\n          duration: 60,\r\n          callback: () => {\r\n            if (!active) return;\r\n            p.image(graphicsFrames[(factor * lastFrameIndex) | 0], x, y);\r\n          }\r\n        },\r\n        {\r\n          duration: 30,\r\n          callback: (timer: Timer) => {\r\n            if (!active) return;\r\n            const frameIndex =\r\n              (factor * (1 - timer.getProgressRatio()) * lastFrameIndex) | 0;\r\n            p.image(graphicsFrames[frameIndex], x, y);\r\n          }\r\n        }\r\n      ],\r\n      loopCallback\r\n    );\r\n\r\n    return {\r\n      step: () => {\r\n        timerChain.step();\r\n      },\r\n      draw: () => {\r\n        timerChain.runPhase();\r\n      },\r\n      setFactor: (newFactor: number) => {\r\n        factor = newFactor;\r\n      }\r\n    };\r\n  };\r\n\r\n  const runDot = (dot: Dot) => {\r\n    dot.step();\r\n    dot.draw();\r\n  };\r\n\r\n  // ---- initialize & reset\r\n  function initializeStyle() {\r\n    p.noFill();\r\n    p.strokeWeight(2);\r\n    p.rectMode(p.CENTER);\r\n    p.imageMode(p.CENTER);\r\n  }\r\n\r\n  function initializeData() {\r\n    graphicsFrames = [];\r\n\r\n    for (let i = 0; i < GRAPHICS_FRAME_LENGTH; i += 1) {\r\n      const ratio = i / (GRAPHICS_FRAME_LENGTH - 1);\r\n      const sizeRatio = easeOutQuad(ratio);\r\n      const alphaRatio = easeOutQuart(ratio);\r\n      const size = sizeRatio * 12;\r\n      const gSize = (12 + size) | 0;\r\n      const graphics = p.createGraphics(gSize, gSize) as any;\r\n      graphics.noStroke();\r\n      graphics.background(backgroundColor);\r\n      graphics.translate(graphics.width / 2, graphics.height / 2);\r\n      graphics.fill(0, alphaRatio * 192);\r\n      graphics.ellipse(0, 0, size, size);\r\n      graphics.filter(p.BLUR, 2);\r\n      graphics.fill(0, alphaRatio * 192);\r\n      graphics.ellipse(0, 0, size, size);\r\n\r\n      graphicsFrames.push(graphics);\r\n    }\r\n  }\r\n\r\n  function reset() {\r\n    p.noiseSeed(100 * Math.random());\r\n    dots = [];\r\n    for (let x = 24; x < p.width; x += 24) {\r\n      for (let y = 24; y < p.height; y += 24) {\r\n        dots.push(createDot(x, y));\r\n      }\r\n    }\r\n  }\r\n\r\n  // ---- core drawing process\r\n  function drawSketch(): void {\r\n    loop(dots, runDot);\r\n  }\r\n\r\n  // ---- setup & draw etc.\r\n  p.preload = () => {};\r\n\r\n  p.setup = () => {\r\n    const nonScaledSize = { width: 640, height: 640 };\r\n    canvas = createScaledCanvas(p, HTML_ELEMENT, nonScaledSize);\r\n    backgroundColor = p.color(252, 252, 255);\r\n    backgroundPixels = createPixels(p, (p: p5) => {\r\n      p.background(backgroundColor);\r\n    });\r\n\r\n    initializeStyle();\r\n    initializeData();\r\n    reset();\r\n  };\r\n\r\n  p.draw = () => {\r\n    p.pixels = backgroundPixels;\r\n    p.updatePixels();\r\n\r\n    canvas.drawScaled(drawSketch);\r\n  };\r\n\r\n  p.mousePressed = () => {\r\n    reset();\r\n  };\r\n\r\n  p.keyTyped = () => {\r\n    if (p.key === \"p\") p.noLoop();\r\n    if (p.key === \"s\") p.save(\"dots.png\");\r\n  };\r\n};\r\n\r\nnew p5(sketch, HTML_ELEMENT);\r\n"],"names":[],"mappings":"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"}