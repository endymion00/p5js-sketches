/**
 * Dots.
 * Website => https://www.fal-works.com/
 * @copyright 2019 FAL
 * @author FAL <falworks.contact@gmail.com>
 * @version 0.1.0
 * @license CC-BY-SA-3.0
 */
!function(){"use strict";const e=e=>document.getElementById(e)||document.body,t=e=>e===document.body?{width:window.innerWidth,height:window.innerHeight}:e.getBoundingClientRect();var n,o;(o=n||(n={})).FIT_TO_BOX="FIT_TO_BOX",o.FIT_WIDTH="FIT_WIDTH",o.FIT_HEIGHT="FIT_HEIGHT";const s=(e,t,n)=>{switch(n){default:case"FIT_TO_BOX":return Math.min(t.width/e.width,t.height/e.height);case"FIT_WIDTH":return t.width/e.width;case"FIT_HEIGHT":return t.height/e.height}};const createTimer=e=>{let t=0;return{step:()=>{t+=1},isCompleted:()=>t===e,reset:()=>{t=0},getProgressRatio:()=>t/e,getCount:()=>t}};const a=e("Dots");var i,r;new p5(n=>{const o=128;let c,l,d,h,u;const g=(e,t)=>{let o=1,s=!0,a=0;const i=h.length-1,r=()=>{a+=1,o=2*(n.noise(.01*e,.01*t,a)-.5),o=Math.min(o+n.random(-.3,.3),1),s=o>0};r();const c=((e,t=(()=>{}))=>{let n=0,o=e[0].callback;const s=e.length,a=[],i=[];for(let t=0,n=e.length;t<n;t+=1)a.push(createTimer(e[t].duration)),i.push(e[t].callback);let r=a[0];return{step:()=>{r.step(),r.isCompleted()&&(r.reset(),(n+=1)>=s&&(n=0,t()),r=a[n],o=e[n].callback)},runPhase:()=>{o(r)}}})([{duration:15,callback:a=>{if(!s)return;const r=o*a.getProgressRatio()*i|0;n.image(h[r],e,t)}},{duration:60,callback:()=>{s&&n.image(h[o*i|0],e,t)}},{duration:30,callback:a=>{if(!s)return;const r=o*(1-a.getProgressRatio())*i|0;n.image(h[r],e,t)}}],r);return{step:()=>{c.step()},draw:()=>{c.runPhase()},setFactor:e=>{o=e}}},p=e=>{e.step(),e.draw()};function w(){n.noiseSeed(100*Math.random()),u=[];for(let e=24;e<n.width;e+=24)for(let t=24;t<n.height;t+=24)u.push(g(e,t))}function T(){!function(e,t){const n=e.length;for(let o=0;o<n;o+=1)t(e[o],o,e)}(u,p)}n.preload=(()=>{}),n.setup=(()=>{c=function(n,o,a,i,r){const c=t("string"==typeof o?e(o):o),l=s(a,c,i);return{p5Canvas:n.createCanvas(l*a.width,l*a.height,r),scaleFactor:l,nonScaledSize:a,drawScaled:e=>(d=n,h=e,u=l,d.scale(u),h(d),void d.scale(1/u))};var d,h,u}(n,a,{width:640,height:640}),d=n.color(252,252,255),r=(e=>{e.background(d)}),(i=n).push(),r(i),i.pop(),i.loadPixels(),l=i.pixels,n.noFill(),n.strokeWeight(2),n.rectMode(n.CENTER),n.imageMode(n.CENTER),function(){h=[];for(let s=0;s<o;s+=1){const a=s/(o-1),i=(t=a,1-Math.pow(t-1,2)),r=(e=a,1-Math.pow(e-1,4)),c=12*i,l=12+c|0,u=n.createGraphics(l,l);u.noStroke(),u.background(d),u.translate(u.width/2,u.height/2),u.fill(0,192*r),u.ellipse(0,0,c,c),u.filter(n.BLUR,2),u.fill(0,192*r),u.ellipse(0,0,c,c),h.push(u)}var e,t}(),w()}),n.draw=(()=>{n.pixels=l,n.updatePixels(),c.drawScaled(T)}),n.mousePressed=(()=>{w()}),n.keyTyped=(()=>{"p"===n.key&&n.noLoop(),"s"===n.key&&n.save("dots.png")})},a)}();