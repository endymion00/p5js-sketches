/**
 * Fragile. 
 * Including module: p5ex (Copyright 2018 FAL, licensed under MIT).
 * Website => https://www.fal-works.com/
 * @copyright 2018 FAL
 * @author FAL <falworks.contact@gmail.com>
 * @version 0.1.0
 * @license CC-BY-SA-3.0
 */
!function(){"use strict";function t(t,e,i,s){return t&&void 0!==e?null===e?new a(t):i?new c(t,e,s):new h(t,e):new l}function e(t,e,i){return t+i*(e-t)}function i(t,i,s,o,n,r,h){!function(t,i,s,o,n,r,h,a=1){const l=t,c=h||l.pixelDensity();for(let d=0;d<c;d+=1)for(let t=0;t<c;t+=1){const h=4*((s*c+t)*l.width*c+(i*c+d));l.pixels[h]=e(l.pixels[h],o,a),l.pixels[h+1]=e(l.pixels[h+1],n,a),l.pixels[h+2]=e(l.pixels[h+2],r,a)}}(t,i,s,o,n,r,void 0,h/255)}class s{}class o extends s{get width(){return this.rightPositionX-this.leftPositionX}get height(){return this.bottomPositionY-this.topPositionY}get area(){return this.width*this.height}constructor(t,e,i,s,o=0){super(),this.leftPositionX=t-o,this.topPositionY=e-o,this.rightPositionX=i+o,this.bottomPositionY=s+o}contains(t,e=0){return t.x>=this.leftPositionX-e&&t.x<=this.rightPositionX+e&&t.y>=this.topPositionY-e&&t.y<=this.bottomPositionY+e}constrain(t,e=0){t.x<this.leftPositionX-e?t.x=this.leftPositionX-e:t.x>this.rightPositionX+e&&(t.x=this.rightPositionX+e),t.y<this.topPositionY-e?t.y=this.topPositionY-e:t.y>this.bottomPositionY+e&&(t.y=this.bottomPositionY+e)}}class n{constructor(t,e,i,s){this.p=t,this.canvasElement=t.createCanvas(e.scaledWidth,e.scaledHeight,s),this.canvasElement&&"parent"in this.canvasElement&&this.canvasElement.parent(i),this.region=new o(0,0,0,0),this.nonScaledShortSideLength=e.nonScaledShortSideLength,this.updateSize()}get scaleFactor(){return this._scaleFactor}get nonScaledWidth(){return this._nonScaledWidth}get nonScaledHeight(){return this._nonScaledHeight}get aspectRatio(){return this._aspectRatio}resize(t){this.p.resizeCanvas(t.scaledWidth,t.scaledHeight),this.nonScaledShortSideLength=t.nonScaledShortSideLength,this.updateSize()}updateSize(){const t=this.p;this._scaleFactor=Math.min(t.width,t.height)/this.nonScaledShortSideLength,this._inversedScaleFactor=1/this._scaleFactor,this._nonScaledWidth=t.width/this._scaleFactor,this._nonScaledHeight=t.height/this._scaleFactor,this._aspectRatio=t.width/t.height,this.region.rightPositionX=this._nonScaledWidth,this.region.bottomPositionY=this._nonScaledHeight}scale(){this.p.scale(this._scaleFactor)}cancelScale(){this.p.scale(this._inversedScaleFactor)}getNonScaledValueOf(t){return t/this._scaleFactor}}n.DUMMY_PARAMETERS={scaledWidth:100,scaledHeight:100,nonScaledShortSideLength:100};const r={SQUARE640x640:"SQUARE640x640",RECT640x480:"RECT640x480",FULL:"FULL",CUSTOM:"CUSTOM"};class h{constructor(t,e){this.p=t,this.p5Color=e}stroke(){this.p.currentRenderer.stroke(this.p5Color)}fill(){this.p.currentRenderer.fill(this.p5Color)}}class a{constructor(t){this.p=t}stroke(){this.p.currentRenderer.noStroke()}fill(){this.p.currentRenderer.noFill()}}class l{stroke(){}fill(){}}class c{constructor(t,e,i=256){this.p=t;const s=[];for(let o=0;o<i;o+=1)s.push(t.color(t.red(e),t.green(e),t.blue(e),t.alpha(e)*o/(i-1)));this.colorArray=s,this.maxIndex=i-1}stroke(t){this.p.currentRenderer.stroke(this.getColor(t))}fill(t){this.p.currentRenderer.fill(this.getColor(t))}getColor(t){return this.colorArray[t?Math.floor(this.p.map(t,0,255,0,this.maxIndex)):this.maxIndex]}}class d{constructor(e,i,s,o,n){this.strokeColor=t(e,i,o,n),this.fillColor=t(e,s,o,n)}applyColor(t){this.strokeColor.stroke(t),this.fillColor.fill(t)}}d.UNDEFINED=new d(void 0,void 0,void 0);const u=()=>{},p=(Math.PI,new p5(t=>{t.setup=(()=>{t.noCanvas()})}));Math.PI,p.createVector(),p.createVector();class g{constructor(t=256){this.array=new Array(t),this.length=0}get(t){return this.array[t]}getLast(){return this.array[this.length-1]}push(t){return this.array[this.length]=t,this.length+=1,this.length}pushRawArray(t,e=t.length){for(let i=0;i<e;i+=1)this.array[this.length+i]=t[i];return this.length+=e,this.length}pushAll(t){return this.pushRawArray(t.array,t.length)}pop(){return this.length-=1,this.array[this.length]}clear(){this.length=0}loop(t){!function(t,e,i){let s=0;for(;s<i;)e(t[s],s,t),s+=1}(this.array,t,this.length)}loopBackwards(t){!function(t,e,i){for(;i--;)e(t[i],i,t)}(this.array,t,this.length)}roundRobin(t){!function(t,e,i){for(let s=0,o=i-1;s<o;s+=1)for(let n=s+1;n<i;n+=1)e(t[s],t[n])}(this.array,t,this.length)}nestedLoopJoin(t,e){!function(t,e,i,s,o){for(let n=0;n<s;n+=1)for(let s=0;s<o;s+=1)i(t[n],e[s])}(this.array,t.array,e,this.length,t.length)}}class m{constructor(t,e){this.nodeA=t,this.nodeB=e}isIncidentTo(t){return t===this.nodeA||t===this.nodeB}getAdjacentNode(t){return t===this.nodeB?this.nodeA:this.nodeB}}class y extends g{static drawFunction(t){t.draw()}draw(){this.loop(y.drawFunction)}}class S extends g{static stepFunction(t){t.step()}step(){this.loop(S.stepFunction)}}class v extends g{}v.prototype.step=S.prototype.step,v.prototype.draw=y.prototype.draw;class x extends g{constructor(t){super(t),this.recentRemovedElements=new g(t)}clean(){this.recentRemovedElements.clear();let t=0;for(let e=0;e<this.length;e+=1)this.array[e].clean(),this.array[e].isToBeRemoved?this.recentRemovedElements.push(this.array[e]):(this.array[t]=this.array[e],t+=1);this.length=t}}class f extends x{}f.prototype.draw=v.prototype.draw,f.prototype.step=v.prototype.step;p.createVector(),p.createVector(),p.createVector();class C{constructor(){this.count=0}resetCount(t=0){return this.count=t,this}step(){this.count+=1}mod(t){return this.count%t}}class w extends C{get isOn(){return this._isOn}constructor(t,e=u){super(),this._isOn=!0,this.completeBehavior=e,this.durationFrameCount=t}on(t){return this._isOn=!0,t&&(this.durationFrameCount=t),this}off(){return this._isOn=!1,this}step(){this._isOn&&(this.count+=1,this.count>this.durationFrameCount&&this.completeCycle())}}class R extends w{constructor(t,e){super(t,e)}on(t){return super.on(t),this}off(){return super.off(),this}getProgressRatio(){return this.count/this.durationFrameCount}completeCycle(){this.completeBehavior(),this.count=0}}class P extends m{constructor(t,e,i,s){super(e,i),this.p=t,this.region=s,this.previousPositionA=this.nodeA.copy(),this.previousPositionB=this.nodeB.copy(),this.velocityA=p5.Vector.random2D().mult(.5),this.velocityB=p5.Vector.random2D().mult(.5);this.timer=new R(120,()=>{this.velocityA.rotate(t.random(t.TWO_PI)),this.velocityB.rotate(t.random(t.TWO_PI))});let o=2,n=4;switch(function(t){return Math.floor(Math.random()*t)}(3)){case 0:o=2,n=4;break;case 1:o=10,n=0;break;case 2:o=2,n=36}this.surfaceColor=new d(t,t.color(0,0,16,o),null,!0),this.edgeColor=new d(t,t.color(0,0,16,n),null,!0)}step(){this.timer.step(),this.previousPositionA.set(this.nodeA),this.previousPositionB.set(this.nodeB),this.nodeA.add(this.velocityA),this.nodeB.add(this.velocityB),(this.nodeA.x<this.region.leftPositionX||this.nodeA.x>this.region.rightPositionX)&&(this.velocityA.x*=-1),(this.nodeA.y<this.region.topPositionY||this.nodeA.y>this.region.bottomPositionY)&&(this.velocityA.y*=-1),(this.nodeB.x<this.region.leftPositionX||this.nodeB.x>this.region.rightPositionX)&&(this.velocityB.x*=-1),(this.nodeB.y<this.region.topPositionY||this.nodeB.y>this.region.bottomPositionY)&&(this.velocityB.y*=-1),this.region.constrain(this.nodeA),this.region.constrain(this.nodeB)}draw(){this.surfaceColor.applyColor(),this.p.line(this.nodeA.x,this.nodeA.y,this.nodeB.x,this.nodeB.y),this.edgeColor.applyColor(),this.p.line(this.previousPositionA.x,this.previousPositionA.y,this.nodeA.x,this.nodeA.y),this.p.line(this.previousPositionB.x,this.previousPositionB.y,this.nodeB.x,this.nodeB.y)}}new class extends p5{setCurrentRenderer(t){this.currentRenderer=t}get nonScaledWidth(){return this.scalableCanvas.nonScaledWidth}get nonScaledHeight(){return this.scalableCanvas.nonScaledHeight}get idealFrameRate(){return this._idealFrameRate}get unitAngleSpeed(){return this._unitAngleSpeed}get unitSpeed(){return this._unitSpeed}get unitAccelerationMagnitude(){return this._unitAccelerationMagnitude}constructor(t,e,i){super(t,"string"==typeof e?document.getElementById(e)||void 0:e,i),this.node=e&&"boolean"!=typeof e?"string"==typeof e?document.getElementById(e)||document.body:e:document.body,this.currentRenderer=this,this.maxCanvasRegion={width:0,height:0,getShortSideLength(){return Math.min(this.width,this.height)}},this.updateMaxCanvasRegion(),this.setFrameRate()}setFrameRate(t=60){return this.frameRate(t),t&&(this._idealFrameRate=t,this._unitAngleSpeed=2*Math.PI/this._idealFrameRate,this._unitSpeed=1/this._idealFrameRate,this._unitAccelerationMagnitude=this._unitSpeed/this._idealFrameRate),this}updateMaxCanvasRegion(){if(this.maxCanvasRegion.width=this.windowWidth,this.maxCanvasRegion.height=this.windowHeight,this.node===document.body)return;const t=this.node.getBoundingClientRect();this.maxCanvasRegion.width=t.width,this.maxCanvasRegion.height=t.height}createScalableCanvas(t,e,i){this.scalableCanvasType=t,this.scalableCanvas=new n(this,this.createScalableCanvasParameter(t,e),this.node,i)}resizeScalableCanvas(t,e){this.scalableCanvas.resize(this.createScalableCanvasParameter(t||this.scalableCanvasType,e))}createScalableCanvasParameter(t,e){this.updateMaxCanvasRegion();const i=this.maxCanvasRegion.getShortSideLength();switch(t){case r.SQUARE640x640:return{scaledWidth:i,scaledHeight:i,nonScaledShortSideLength:640};case r.RECT640x480:return{scaledWidth:i,scaledHeight:.75*i,nonScaledShortSideLength:480};case r.FULL:return{scaledWidth:this.maxCanvasRegion.width,scaledHeight:this.maxCanvasRegion.height,nonScaledShortSideLength:640};default:return e||n.DUMMY_PARAMETERS}}}(t=>{function e(){t.background(s),function(t,e,s=!0,o=0,n=0,r=0){const h=t,a=h.width,l=h.height,c=s?i:function(t,e,i,s,o,n,r,h){const a=t,l=h||a.pixelDensity();for(let c=0;c<l;c+=1)for(let t=0;t<l;t+=1){const h=4*((i*l+t)*a.width*l+(e*l+c));a.pixels[h]=s,a.pixels[h+1]=o,a.pixels[h+2]=n,a.pixels[h+3]=r}};h.loadPixels();for(let i=0;i<l;i+=1)for(let s=0;s<a;s+=1)c(t,s,i,o,n,r,Math.random()*e);h.updatePixels()}(t,32,!0,208,208,255);const e=new o(-200,-200,200,200),n=p5.Vector.random2D().mult(50);a=new P(t,n,p5.Vector.mult(n,-1),e)}let s,n=-1,h=!0;let a;t.preload=(()=>{}),t.setup=(()=>{t.createScalableCanvas(r.SQUARE640x640),s=t.color(255,255,255),e()}),t.draw=(()=>{t.scalableCanvas.scale(),t.translate(.5*t.nonScaledWidth,.5*t.nonScaledHeight);for(let t=0;t<8;t+=1)a.step(),a.draw();t.scalableCanvas.cancelScale()}),t.windowResized=(()=>{t.resizeScalableCanvas(),-1!==n&&clearTimeout(n),n=setTimeout(e,200)}),t.mousePressed=(()=>{(function(t){return!(t.mouseX<0||t.mouseX>t.width||t.mouseY<0||t.mouseY>t.height)})(t)&&(h?t.noLoop():(t.loop(),e()),h=!h)}),t.keyTyped=(()=>{"s"===t.key&&t.saveCanvas("fragile","png")})},"Fragile")}();