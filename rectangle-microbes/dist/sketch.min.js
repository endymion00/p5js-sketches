/**
 * Rectangle Microbes.
 * Website => https://www.fal-works.com/
 * Including module: p5ex (Copyright 2018 FAL, licensed under MIT).
 * @copyright 2018 FAL
 * @author FAL <falworks.contact@gmail.com>
 * @version 0.1.0
 * @license CC-BY-SA-3.0
 */
!function(){"use strict";function t(t,e,i,s){return t&&void 0!==e?null===e?new r(t):i?new o(t,e,s):new n(t,e):new a}function e(t){return t[function(t){return Math.floor(Math.random()*t)}(t.length)]}class i{constructor(t,e,i,s){this.p=t,this.canvasElement=t.createCanvas(e.scaledWidth,e.scaledHeight,s),this.canvasElement&&"parent"in this.canvasElement&&this.canvasElement.parent(i),this.nonScaledShortSideLength=e.nonScaledShortSideLength,this.updateSize()}get scaleFactor(){return this._scaleFactor}get nonScaledWidth(){return this._nonScaledWidth}get nonScaledHeight(){return this._nonScaledHeight}get aspectRatio(){return this._aspectRatio}resize(t){this.p.resizeCanvas(t.scaledWidth,t.scaledHeight),this.nonScaledShortSideLength=t.nonScaledShortSideLength,this.updateSize()}updateSize(){const t=this.p;this._scaleFactor=Math.min(t.width,t.height)/this.nonScaledShortSideLength,this._inversedScaleFactor=1/this._scaleFactor,this._nonScaledWidth=t.width/this._scaleFactor,this._nonScaledHeight=t.height/this._scaleFactor,this._aspectRatio=t.width/t.height}scale(){this.p.scale(this._scaleFactor)}cancelScale(){this.p.scale(this._inversedScaleFactor)}getNonScaledValueOf(t){return t/this._scaleFactor}}i.DUMMY_PARAMETERS={scaledWidth:100,scaledHeight:100,nonScaledShortSideLength:100};const s={SQUARE640x640:"SQUARE640x640",RECT640x480:"RECT640x480",FULL:"FULL",CUSTOM:"CUSTOM"};class n{constructor(t,e){this.p=t,this.p5Color=e}stroke(){this.p.currentRenderer.stroke(this.p5Color)}fill(){this.p.currentRenderer.fill(this.p5Color)}}class r{constructor(t){this.p=t}stroke(){this.p.currentRenderer.noStroke()}fill(){this.p.currentRenderer.noFill()}}class a{stroke(){}fill(){}}class o{constructor(t,e,i=256){this.p=t;const s=[];for(let n=0;n<i;n+=1)s.push(t.color(t.red(e),t.green(e),t.blue(e),t.alpha(e)*n/(i-1)));this.colorArray=s,this.maxIndex=i-1}stroke(t){this.p.currentRenderer.stroke(this.getColor(t))}fill(t){this.p.currentRenderer.fill(this.getColor(t))}getColor(t){return this.colorArray[t?Math.floor(this.p.map(t,0,255,0,this.maxIndex)):this.maxIndex]}}class h{constructor(e,i,s,n,r){this.strokeColor=t(e,i,n,r),this.fillColor=t(e,s,n,r)}applyColor(t){this.strokeColor.stroke(t),this.fillColor.fill(t)}}h.UNDEFINED=new h(void 0,void 0,void 0);const c=()=>{},l=(Math.PI,new p5(t=>{t.setup=(()=>{t.noCanvas()})}));Math.PI,l.createVector(),l.createVector();class d{}class u extends d{get width(){return this.rightPositionX-this.leftPositionX}get height(){return this.bottomPositionY-this.topPositionY}get area(){return this.width*this.height}constructor(t,e,i,s,n=0){super(),this.leftPositionX=t-n,this.topPositionY=e-n,this.rightPositionX=i+n,this.bottomPositionY=s+n}contains(t){return t.x>=this.leftPositionX&&t.x<=this.rightPositionX&&t.y>=this.topPositionY&&t.y<=this.bottomPositionY}}class p{constructor(){this.candidateArray=[]}pushCandidateFromFunction(t,e){for(let i=0;i<e;i+=1)this.candidateArray.push(t());return this}pushCandidate(t,e=1){for(let i=0;i<e;i+=1)this.candidateArray.push(t);return this}clear(){return this.candidateArray.length=0,this}get(){return e(this.candidateArray)}}class g{constructor(t=256){this.array=new Array(t),this.length=0}get(t){return this.array[t]}getLast(){return this.array[this.length-1]}push(t){return this.array[this.length]=t,this.length+=1,this.length}pushRawArray(t,e=t.length){for(let i=0;i<e;i+=1)this.array[this.length+i]=t[i];return this.length+=e,this.length}pushAll(t){return this.pushRawArray(t.array,t.length)}pop(){return this.length-=1,this.array[this.length]}clear(){this.length=0}loop(t){!function(t,e,i){let s=0;for(;s<i;)e(t[s],s,t),s+=1}(this.array,t,this.length)}loopBackwards(t){!function(t,e,i){for(;i--;)e(t[i],i,t)}(this.array,t,this.length)}roundRobin(t){!function(t,e,i){for(let s=0,n=i-1;s<n;s+=1)for(let r=s+1;r<i;r+=1)e(t[s],t[r])}(this.array,t,this.length)}nestedLoopJoin(t,e){!function(t,e,i,s,n){for(let r=0;r<s;r+=1)for(let s=0;s<n;s+=1)i(t[r],e[s])}(this.array,t.array,e,this.length,t.length)}}class m extends g{static drawFunction(t){t.draw()}draw(){this.loop(m.drawFunction)}}class C extends g{static stepFunction(t){t.step()}step(){this.loop(C.stepFunction)}}class S extends g{}S.prototype.step=C.prototype.step,S.prototype.draw=m.prototype.draw;class w extends g{constructor(t){super(t),this.recentRemovedElements=new g(t)}clean(){this.recentRemovedElements.clear();let t=0;for(let e=0;e<this.length;e+=1)this.array[e].clean(),this.array[e].isToBeRemoved?this.recentRemovedElements.push(this.array[e]):(this.array[t]=this.array[e],t+=1);this.length=t}}class R extends w{}R.prototype.draw=S.prototype.draw,R.prototype.step=S.prototype.step;l.createVector(),l.createVector(),l.createVector();class f{constructor(){this.count=0}resetCount(t=0){return this.count=t,this}step(){this.count+=1}mod(t){return this.count%t}}class y extends f{get isOn(){return this._isOn}constructor(t,e=c){super(),this._isOn=!0,this.completeBehavior=e,this.durationFrameCount=t}on(t){return this._isOn=!0,t&&(this.durationFrameCount=t),this}off(){return this._isOn=!1,this}step(){this._isOn&&(this.count+=1,this.count>this.durationFrameCount&&this.completeCycle())}}class v extends y{get isCompleted(){return this._isCompleted}constructor(t,e){super(t,e),this._isCompleted=!1}on(t){return super.on(t),this}off(){return super.off(),this}resetCount(){return super.resetCount(),this._isCompleted=!1,this}getProgressRatio(){return this._isCompleted?1:this.count/this.durationFrameCount}completeCycle(){this._isCompleted=!0,this._isOn=!1,this.completeBehavior()}}class x{}class F extends x{constructor(){super(...arguments),this.widthFactor=1.25,this.heightFactor=.75}}class _ extends x{constructor(){super(...arguments),this.widthFactor=.75,this.heightFactor=1.25}}class P{constructor(t,e){this.p=t,this.size=e,this.isToBeRemoved=!1,P.isInitialized||(P.resetRegion(t),P.colors=(new p).pushCandidate(new h(t,null,t.color(32,32,32),!0)).pushCandidate(new h(t,null,t.color("#263de2"),!0)).pushCandidate(new h(t,null,t.color("#b00101"),!0)).pushCandidate(new h(t,null,t.color("#d2a908"),!0)),P.isInitialized=!0);const i=P.region;this.position=t.createVector(t.random(i.leftPositionX+100,i.rightPositionX-100),t.random(i.topPositionY+100,i.bottomPositionY-100)),this.direction=t.random(P.directions),this.shapeColor=P.colors.get(),this.totalElapsedInternalTime=1e4*Math.random(),this.appearanceTimer=new v(120),this.accelerationTimer=new v(60).off(),this.decelerationTimer=new v(60,()=>{this.accelerationTimer.resetCount().on()}).off()}static resetRegion(t){P.region=new u(0,0,t.nonScaledWidth,t.nonScaledHeight,50)}step(){this.appearanceTimer.step(),this.accelerationTimer.step(),this.decelerationTimer.step();const t=32*(this.accelerationTimer.isOn?this.accelerationTimer.getProgressRatio():this.decelerationTimer.isOn?1-this.decelerationTimer.getProgressRatio():1)/this.size,e=2*t;this.direction.changePosition(this.position,e),this.totalElapsedInternalTime+=t,Math.random()<.01&&(this.direction=this.p.random(P.directions)),!this.accelerationTimer.isOn&&!this.decelerationTimer.isOn&&Math.random()<.01&&this.decelerationTimer.resetCount().on()}clean(){P.region.contains(this.position)||(this.isToBeRemoved=!0)}draw(){this.shapeColor.applyColor(255*this.appearanceTimer.getProgressRatio());const t=1+.25*Math.sin(.1*this.totalElapsedInternalTime),e=1+.25*Math.sin(Math.PI+.1*this.totalElapsedInternalTime);this.p.rect(this.position.x,this.position.y,t*this.direction.widthFactor*this.size,e*this.direction.heightFactor*this.size)}}P.isInitialized=!1,P.directions=[new class extends F{changePosition(t,e){t.x-=e}},new class extends _{changePosition(t,e){t.y-=e}},new class extends F{changePosition(t,e){t.x+=e}},new class extends _{changePosition(t,e){t.y+=e}}],p5.disableFriendlyErrors=!0;new p5;new class extends p5{setCurrentRenderer(t){this.currentRenderer=t}get nonScaledWidth(){return this.scalableCanvas.nonScaledWidth}get nonScaledHeight(){return this.scalableCanvas.nonScaledHeight}get idealFrameRate(){return this._idealFrameRate}get unitAngleSpeed(){return this._unitAngleSpeed}get unitSpeed(){return this._unitSpeed}get unitAccelerationMagnitude(){return this._unitAccelerationMagnitude}constructor(t,e,i){super(t,"string"==typeof e?document.getElementById(e)||void 0:e,i),this.node=e&&"boolean"!=typeof e?"string"==typeof e?document.getElementById(e)||document.body:e:document.body,this.currentRenderer=this,this.maxCanvasRegion={width:0,height:0,getShortSideLength(){return Math.min(this.width,this.height)}},this.updateMaxCanvasRegion(),this.setFrameRate()}setFrameRate(t=60){return this.frameRate(t),t&&(this._idealFrameRate=t,this._unitAngleSpeed=2*Math.PI/this._idealFrameRate,this._unitSpeed=1/this._idealFrameRate,this._unitAccelerationMagnitude=this._unitSpeed/this._idealFrameRate),this}updateMaxCanvasRegion(){if(this.maxCanvasRegion.width=this.windowWidth,this.maxCanvasRegion.height=this.windowHeight,this.node===document.body)return;const t=this.node.getBoundingClientRect();this.maxCanvasRegion.width=t.width,this.maxCanvasRegion.height=t.height}createScalableCanvas(t,e,s){this.scalableCanvasType=t,this.scalableCanvas=new i(this,this.createScalableCanvasParameter(t,e),this.node,s)}resizeScalableCanvas(t,e){this.scalableCanvas.resize(this.createScalableCanvasParameter(t||this.scalableCanvasType,e))}createScalableCanvasParameter(t,e){this.updateMaxCanvasRegion();const n=this.maxCanvasRegion.getShortSideLength();switch(t){case s.SQUARE640x640:return{scaledWidth:n,scaledHeight:n,nonScaledShortSideLength:640};case s.RECT640x480:return{scaledWidth:n,scaledHeight:.75*n,nonScaledShortSideLength:480};case s.FULL:return{scaledWidth:this.maxCanvasRegion.width,scaledHeight:this.maxCanvasRegion.height,nonScaledShortSideLength:640};default:return e||i.DUMMY_PARAMETERS}}}(t=>{function e(){return function(t,e,i,s,n,r){const a=t.createGraphics(e,i);a.background(s),a.strokeWeight(2);for(let o=0;o<i;o+=1){const s=o/(i-1);a.stroke(t.lerpColor(n,r,s)),a.line(0,o,e-1,o)}return a}(t,t.width,t.height,t.color(255,255,255),t.color(248,248,248),t.color(240,240,255))}let i,n;t.preload=(()=>{}),t.setup=(()=>{window.noCanvas(),t.createScalableCanvas(s.FULL),i=e(),t.rectMode(t.CENTER),n=new R(256)}),t.draw=(()=>{t.image(i,0,0),t.scalableCanvas.scale(),function(){if(n.length>50)return;const e=new P(t,6+24*t.sq(Math.random()));n.push(e)}(),n.step(),n.clean(),n.draw()}),t.windowResized=(()=>{t.resizeScalableCanvas(),i=e(),P.resetRegion(t)}),t.mousePressed=(()=>{}),t.touchMoved=(()=>{if(!(t.mouseX<0||t.mouseX>t.width||t.mouseY<0||t.mouseY>t.height))return!1})},"RectangleMicrobes")}();