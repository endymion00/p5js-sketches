/**
 * Rotational Symmetry.
 * Website => https://www.fal-works.com/
 * @copyright 2019 FAL
 * @author FAL <falworks.contact@gmail.com>
 * @version 0.1.4
 * @license CC-BY-SA-3.0
 */
!function(){"use strict";function t(t){return document.getElementById(t)||document.body}function n(t){return Math.floor(Math.random()*t)}function e(t,e){return t+n(e-t)}function o(t){const e=t.length;if(0===e)throw new Error("Passed empty array.");return t[n(e)]}function r(t,n){const e=t.length;for(let o=0;o<e;o+=1)n(t[o],o,t)}var i,a;function l(n,e,o,r,a){let l;const u=function(t,n,e){switch(e){default:case i.FIT_TO_BOX:const o=n.width/t.width,r=t.height,a=n.height;return o*r<a?o:a/r;case i.FIT_WIDTH:return n.width/t.width;case i.FIT_HEIGHT:return n.height/t.height}}(o,function(t){if(t===document.body)return{width:window.innerWidth,height:window.innerHeight};const n=t.getBoundingClientRect();return{width:n.width,height:n.height}}(l="string"==typeof e?t(e):e),r);return{p5Canvas:n.createCanvas(u*o.width,u*o.height,a),scaleFactor:u}}function u(t,n,e,o,r,i,a,l){const u=t,c=l||u.pixelDensity(),s=u.pixels;for(let t=0;t<c;t+=1)for(let l=0;l<c;l+=1){const d=4*((e*c+l)*u.width*c+(n*c+t));s[d]=o,s[d+1]=r,s[d+2]=i,s[d+3]=a}}(a=i||(i={}))[a.FIT_TO_BOX=0]="FIT_TO_BOX",a[a.FIT_WIDTH=1]="FIT_WIDTH",a[a.FIT_HEIGHT=2]="FIT_HEIGHT";const c=t("RotationalSymmetry"),s=["#C7243A","#2266AF","#009250","#EDAD0B"];var d,h,f,p,m;new p5(t=>{let n,i,a,w,g,F;function x(n){n.applyColor();const e=n.revolution%t.TWO_PI,o=n.count,r=n.shape,i=n.radius,a=n.shapeSize,l=n.rotationFactor;let u=e;const c=t.TWO_PI/o,s=()=>r.draw(a);for(let n=0;n<o;n+=1){const n=i*Math.cos(u),o=i*Math.sin(u);h=s,f=n,p=o,m=u+(l||0)*e,w=void 0,g=void 0,F=void 0,(d=t).translate(f,p),g=h,F=m,(w=d).rotate(F),g(w),w.rotate(-F),d.translate(-f,-p),u+=c}var d,h,f,p,m,w,g,F;n.revolution=e+n.revolutionVelocity}function T(n){var e,o,i,a;e=t,o=(()=>r(n.shapeGroupList,x)),i=n.x,a=n.y,e.translate(i,a),o(e),e.translate(-i,-a)}const b=1/3,v=2/3,y=1/t.sqrt(3);function I(n,e,r,i,a){const l=o(n),u=a.pop();if(!u)throw new Error("No colors in stack.");let c;switch(l.maxFoldingNumber){case 1:c=1;break;case 4:c=o([-2,-1,0,1,2]);break;case 1/0:c=null;break;default:c=o([-2,0,2])}return{shape:l,count:e,shapeSize:18,radius:r,revolution:0,revolutionVelocity:.004*i*t.TWO_PI,applyColor:u,rotationFactor:c}}function N(n,o,r,i,a=!1){const l=t.shuffle(i,!1),u=a?-1:1;return{x:n,y:o,shapeGroupList:[I(r,e(3,6),35,-u,l),I(r,e(4,10),75,u,l)]}}function k(n){if(n.maxFoldingNumber===1/0)return null;const e=t.TWO_PI/n.maxFoldingNumber*.5;return{draw:o=>{t.rotate(e),n.draw(o),t.rotate(-e)},maxFoldingNumber:n.maxFoldingNumber}}function _(n,e){return{draw:o=>{const r=e*o;t.translate(r,0),n.draw(o),t.translate(-r,0)},maxFoldingNumber:1}}function C(t,n,e){return{draw:e=>{t.draw(e),n.draw(e)},maxFoldingNumber:e}}function E(t){const n=t.maxFoldingNumber;let e;return e=n===1/0?2:n%2==0?2:1,C(_(t,-.2),_(t,.2),e)}function O(t){const n=[t],e=k(t);e&&(n.push(e),n.push(function(t){const n=k(t);if(!n)throw new Error("Could not create rotated shape.");return C(t,n,2*t.maxFoldingNumber)}(t)),n.push(E(e)));const o=E(t);if(n.push(o),2===o.maxFoldingNumber){const t=k(o);t&&n.push(t)}return n}function H(){var n;n=[{draw:function(n){t.rect(0,0,n,n,.05*n)},maxFoldingNumber:4},{draw:function(n){const e=1.2*n,o=-b*e,r=v*e,i=y*e;t.triangle(r,0,o,-i,o,i)},maxFoldingNumber:3},{draw:function(n){t.ellipse(0,0,n,n)},maxFoldingNumber:1/0},{draw:function(n){t.ellipse(0,0,.9*n,1.3*n)},maxFoldingNumber:2},{draw:function(n){t.quad(.9*n,0,0,.6*n,-.9*n,0,0,-.6*n)},maxFoldingNumber:2},{draw:function(n){t.beginShape(),t.vertex(.8*n,0),t.vertex(0,.5*n),t.curveVertex(-.4*n,0),t.vertex(0,-.5*n),t.endShape(t.CLOSE)},maxFoldingNumber:1}].map(O),g=[].concat.apply([],n),F=s.map(n=>t.color(n)).map(n=>(function(t,n){const e=n.strokeColor,o=n.fillColor;return e&&o?()=>{t.stroke(e),t.fill(o)}:e?null===o?()=>{t.stroke(e),t.noFill()}:()=>{t.stroke(e)}:o?null===e?()=>{t.noStroke(),t.fill(o)}:()=>t.fill(o):null===e?null===o?()=>{t.noStroke(),t.noFill()}:()=>t.noStroke():null===o?()=>t.noFill():()=>{}})(t,{strokeColor:n,fillColor:void 0}))}function P(){w=[];let t=!1;const e=n.width/3;for(let n=0;n<3;n+=1){const o=(n+.5)*e;for(let n=0;n<3;n+=1){const r=N((n+.5)*e,o,g,F,t);w.push(r),t=!t}}}function S(){r(w,T)}t.preload=(()=>{}),t.setup=(()=>{i=l(t,c,n={width:640,height:640}),m=(t=>{t.background(255),t.scale(i.scaleFactor),t.image(function(t,n,e){const o=t.createGraphics(n.width,n.height),r=o.width,i=o.height,a=o.pixelDensity();o.loadPixels();for(let t=0;t<i;t+=1)for(let n=0;n<r;n+=1)u(o,n,t,0,0,0,255*Math.random()*e,a);return o.updatePixels(),o}(t,n,.05),0,0)}),(p=t).push(),m(p),p.pop(),p.loadPixels(),a=p.pixels,t.noFill(),t.strokeWeight(2),t.rectMode(t.CENTER),H(),P()}),t.draw=(()=>{t.pixels=a,t.updatePixels(),d=t,h=S,f=i.scaleFactor,d.scale(f),h(d),d.scale(1/f)}),t.mousePressed=(()=>{P()}),t.keyTyped=(()=>{"p"===t.key&&t.noLoop()})},c)}();