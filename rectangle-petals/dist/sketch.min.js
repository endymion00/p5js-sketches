/**
 * Rectangle Petals.
 * Website => https://www.fal-works.com/
 * Including module: p5ex (Copyright 2018 FAL, licensed under MIT).
 * @copyright 2018 FAL
 * @author FAL <falworks.contact@gmail.com>
 * @version 0.1.0
 * @license CC-BY-SA-3.0
 */
!function(){"use strict";class t{}class e extends t{get width(){return this.rightPositionX-this.leftPositionX}get height(){return this.bottomPositionY-this.topPositionY}get area(){return this.width*this.height}constructor(t,e,s,i,n=0){super(),this.leftPositionX=t-n,this.topPositionY=e-n,this.rightPositionX=s+n,this.bottomPositionY=i+n}contains(t,e=0){return t.x>=this.leftPositionX-e&&t.x<=this.rightPositionX+e&&t.y>=this.topPositionY-e&&t.y<=this.bottomPositionY+e}constrain(t,e=0){t.x<this.leftPositionX-e?t.x=this.leftPositionX-e:t.x>this.rightPositionX+e&&(t.x=this.rightPositionX+e),t.y<this.topPositionY-e?t.y=this.topPositionY-e:t.y>this.bottomPositionY+e&&(t.y=this.bottomPositionY+e)}}class s{constructor(t,s,i,n){this.p=t,this.canvasElement=t.createCanvas(s.scaledWidth,s.scaledHeight,n),this.canvasElement&&"parent"in this.canvasElement&&this.canvasElement.parent(i),this.region=new e(0,0,0,0),this.nonScaledShortSideLength=s.nonScaledShortSideLength,this.updateSize()}get scaleFactor(){return this._scaleFactor}get nonScaledWidth(){return this._nonScaledWidth}get nonScaledHeight(){return this._nonScaledHeight}get aspectRatio(){return this._aspectRatio}resize(t){this.p.resizeCanvas(t.scaledWidth,t.scaledHeight),this.nonScaledShortSideLength=t.nonScaledShortSideLength,this.updateSize()}updateSize(){const t=this.p;this._scaleFactor=Math.min(t.width,t.height)/this.nonScaledShortSideLength,this._inversedScaleFactor=1/this._scaleFactor,this._nonScaledWidth=t.width/this._scaleFactor,this._nonScaledHeight=t.height/this._scaleFactor,this._aspectRatio=t.width/t.height,this.region.rightPositionX=this._nonScaledWidth,this.region.bottomPositionY=this._nonScaledHeight}scale(){this.p.scale(this._scaleFactor)}cancelScale(){this.p.scale(this._inversedScaleFactor)}getNonScaledValueOf(t){return t/this._scaleFactor}}s.DUMMY_PARAMETERS={scaledWidth:100,scaledHeight:100,nonScaledShortSideLength:100};const i={SQUARE640x640:"SQUARE640x640",RECT640x480:"RECT640x480",FULL:"FULL",CUSTOM:"CUSTOM"};class n{constructor(t,e){this.p=t,this.p5Color=e}stroke(){this.p.currentRenderer.stroke(this.p5Color)}fill(){this.p.currentRenderer.fill(this.p5Color)}}class a{constructor(t){this.p=t}stroke(){this.p.currentRenderer.noStroke()}fill(){this.p.currentRenderer.noFill()}}class r{stroke(){}fill(){}}class o{constructor(t,e,s=256){this.p=t;const i=[];for(let n=0;n<s;n+=1)i.push(t.color(t.red(e),t.green(e),t.blue(e),t.alpha(e)*n/(s-1)));this.colorArray=i,this.maxIndex=s-1}stroke(t){this.p.currentRenderer.stroke(this.getColor(t))}fill(t){this.p.currentRenderer.fill(this.getColor(t))}getColor(t){return this.colorArray[t?Math.floor(this.p.map(t,0,255,0,this.maxIndex)):this.maxIndex]}}function h(t,e,s,i){return t&&void 0!==e?null===e?new a(t):s?new o(t,e,i):new n(t,e):new r}class l{constructor(t,e,s,i,n){this.strokeColor=h(t,e,i,n),this.fillColor=h(t,s,i,n)}applyColor(t){this.strokeColor.stroke(t),this.fillColor.fill(t)}}l.UNDEFINED=new l(void 0,void 0,void 0);const c=()=>{},u=(Math.PI,new p5(t=>{t.setup=(()=>{t.noCanvas()})}));Math.PI,u.createVector(),u.createVector();function p(t,e,s){return t+s*(e-t)}function d(t){return t[(e=t.length,Math.floor(Math.random()*e))];var e}class g{constructor(t=0){this.value=t}valueOf(){return this.value}}g.NULL=new g;class f{constructor(){this.candidateArray=[]}pushCandidateFromFunction(t,e){for(let s=0;s<e;s+=1)this.candidateArray.push(t());return this}pushCandidate(t,e=1){for(let s=0;s<e;s+=1)this.candidateArray.push(t);return this}clear(){return this.candidateArray.length=0,this}get(){return d(this.candidateArray)}}const R=t=>t>6/29?t*t*t:6/29*3*(6/29)*(t-16/116);const m=[[3.2406255,-1.537208,-.4986286],[-.9689307,1.8757561,.0415175],[.0557101,-.2040211,1.0569959]];class y{constructor(t,e){this.name=t,this.tristimulusValues=e}}let C={D50:new y("D50",[.9642,1,.8251]),D55:new y("D55",[.9568,1,.9214]),D65:new y("D65",[.95047,1,1.08883]),E:new y("E",[1,1,1])}.D50;const S=[0,0,0],w=[0,0,0],v=[0,0,0],x=[0,0,0];function P(t,e,s,i){return t[0]=e,t[1]=s,t[2]=i,t}function F(t){return 255*((e=Math.min(Math.max(t,0),1))<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055);var e}function _(t,e,s,i){const n=function(t,e,s){const i=(t[0]+16)/116,n=i+t[1]/500,a=i-t[2]/200;return s?(s[0]=e.tristimulusValues[0]*R(n),s[1]=e.tristimulusValues[1]*R(i),s[2]=e.tristimulusValues[2]*R(a),s):[e.tristimulusValues[0]*R(n),e.tristimulusValues[1]*R(i),e.tristimulusValues[2]*R(a)]}(P(S,t,e,s),C,w),a=function(t,e,s){const i=t.length,n=t[0].length,a=s||new Array(i);for(let r=0;r<i;r+=1){a[r]=0;for(let s=0;s<n;s+=1)a[r]+=t[r][s]*e[s]}return a}(m,n,v),r=P(x,F(a[0]),F(a[1]),F(a[2]));return i?[r[0],r[1],r[2],i]:[r[0],r[1],r[2]]}function L(t,e,s,i){return _(t,e*Math.cos(s),e*Math.sin(s),i)}class M{constructor(t=256){this.array=new Array(t),this.length=0}get(t){return this.array[t]}getLast(){return this.array[this.length-1]}push(t){return this.array[this.length]=t,this.length+=1,this.length}pushRawArray(t,e=t.length){for(let s=0;s<e;s+=1)this.array[this.length+s]=t[s];return this.length+=e,this.length}pushAll(t){return this.pushRawArray(t.array,t.length)}pop(){return this.length-=1,this.array[this.length]}clear(){this.length=0}loop(t){!function(t,e,s){let i=0;for(;i<s;)e(t[i],i,t),i+=1}(this.array,t,this.length)}loopBackwards(t){!function(t,e,s){for(;s--;)e(t[s],s,t)}(this.array,t,this.length)}roundRobin(t){!function(t,e,s){for(let i=0,n=s-1;i<n;i+=1)for(let a=i+1;a<s;a+=1)e(t[i],t[a])}(this.array,t,this.length)}nestedLoopJoin(t,e){!function(t,e,s,i,n){for(let a=0;a<i;a+=1)for(let i=0;i<n;i+=1)s(t[a],e[i])}(this.array,t.array,e,this.length,t.length)}}class V extends M{static drawFunction(t){t.draw()}draw(){this.loop(V.drawFunction)}}class A extends M{static stepFunction(t){t.step()}step(){this.loop(A.stepFunction)}}class b extends M{}b.prototype.step=A.prototype.step,b.prototype.draw=V.prototype.draw;class W extends M{constructor(t){super(t),this.recentRemovedElements=new M(t)}clean(){this.recentRemovedElements.clear();let t=0;for(let e=0;e<this.length;e+=1)this.array[e].clean(),this.array[e].isToBeRemoved?this.recentRemovedElements.push(this.array[e]):(this.array[t]=this.array[e],t+=1);this.length=t}}class E extends W{}E.prototype.draw=b.prototype.draw,E.prototype.step=b.prototype.step;class T{constructor(t,e=1){this.p=t,this.internalValue=e,this.internalReciprocalValue=1/e}get value(){return this.internalValue}set value(t){if(0===t)return this.internalValue=1e-4,void(this.internalReciprocalValue=1e4);this.internalValue=t,this.internalReciprocalValue=1/t}get reciprocalValue(){return this.internalReciprocalValue}applyScale(){this.p.currentRenderer.scale(this.internalValue)}cancel(){this.p.currentRenderer.scale(this.internalReciprocalValue)}}class O{constructor(t,e,s){this.p=t,this.set(e,s)}set(t,e){this.element=t,this.position=e.positionRef||this.p.createVector(),this.offsetPosition=e.offsetPositionRef||this.p.createVector(),this.rotation=e.rotationAngleRef||g.NULL,this.scaleFactor=e.scaleFactorRef||new T(this.p),this.shapeColor=e.shapeColorRef||l.UNDEFINED,this.alphaChannel=e.alphaChannelRef||g.NULL,this.strokeWeight=e.strokeWeightRef||g.NULL,this.textSize=e.textSizeRef||g.NULL,this.procedureList=this.createProcedureList(e),this.procedureListLength=this.procedureList.length}draw(){for(let t=0,e=this.procedureListLength;t<e;t+=1)this.procedureList[t](this)}drawElement(t){t.element.draw()}createProcedureList(t){const e=[];return t.shapeColorRef&&(t.alphaChannelRef?e.push(this.alphaColor):e.push(this.color)),t.textSizeRef&&e.push(this.applyTextSize),t.strokeWeightRef&&e.push(this.applyStrokeWeight),t.positionRef?t.offsetPositionRef?e.push(this.translateWithOffset):e.push(this.translate):t.offsetPositionRef&&e.push(this.translateOnlyOffset),t.scaleFactorRef&&e.push(this.scale),t.rotationAngleRef&&e.push(this.rotate),e.push(this.drawElement),t.rotationAngleRef&&e.push(this.cancelRotate),t.scaleFactorRef&&e.push(this.cancelScale),t.positionRef?t.offsetPositionRef?e.push(this.cancelTranslateWithOffset):e.push(this.cancelTranslate):t.offsetPositionRef&&e.push(this.cancelTranslateOnlyOffset),e}translate(t){t.p.currentRenderer.translate(t.position.x,t.position.y)}cancelTranslate(t){t.p.currentRenderer.translate(-t.position.x,-t.position.y)}translateOnlyOffset(t){t.p.currentRenderer.translate(t.offsetPosition.x,t.offsetPosition.y)}cancelTranslateOnlyOffset(t){t.p.currentRenderer.translate(-t.offsetPosition.x,-t.offsetPosition.y)}translateWithOffset(t){t.p.currentRenderer.translate(t.position.x+t.offsetPosition.x,t.position.y+t.offsetPosition.y)}cancelTranslateWithOffset(t){t.p.currentRenderer.translate(-(t.position.x+t.offsetPosition.x),-(t.position.y+t.offsetPosition.y))}rotate(t){t.p.currentRenderer.rotate(t.rotation.value)}cancelRotate(t){t.p.currentRenderer.rotate(-t.rotation.value)}scale(t){1!==t.scaleFactor.value&&t.scaleFactor.applyScale()}cancelScale(t){1!==t.scaleFactor.value&&t.scaleFactor.cancel()}color(t){t.shapeColor.applyColor()}alphaColor(t){t.shapeColor.applyColor(t.alphaChannel.value)}applyStrokeWeight(t){t.p.currentRenderer.strokeWeight(t.strokeWeight.value)}applyTextSize(t){t.p.currentRenderer.textSize(t.textSize.value)}}u.createVector(),u.createVector();function k(t,e,s,i,n,a,r,o=1){const h=t,l=r||h.pixelDensity();for(let c=0;c<l;c+=1)for(let t=0;t<l;t+=1){const r=4*((s*l+t)*h.width*l+(e*l+c));h.pixels[r]=p(h.pixels[r],i,o),h.pixels[r+1]=p(h.pixels[r+1],n,o),h.pixels[r+2]=p(h.pixels[r+2],a,o)}}class U{static get NULL(){return z}constructor(t=0,e=0){this.angleReference=new g(t),this.angleVelocityReference=new g(e)}get angle(){return this.angleReference.value}set angle(t){this.angleReference.value=t}get angleVelocity(){return this.angleVelocityReference.value}set angleVelocity(t){this.angleVelocityReference.value=t}step(){this.angle+=this.angleVelocity}}const z=new class extends U{get angle(){return 0}set angle(t){}get angleVelocity(){return 0}set angleVelocity(t){}step(){}};u.createVector();class D{constructor(){this.count=0}resetCount(t=0){return this.count=t,this}step(){this.count+=1}mod(t){return this.count%t}}class H extends D{get isOn(){return this._isOn}constructor(t,e=c){super(),this._isOn=!0,this.completeBehavior=e,this.durationFrameCount=t}on(t){return this._isOn=!0,t&&(this.durationFrameCount=t),this}off(){return this._isOn=!1,this}step(){this._isOn&&(this.count+=1,this.count>this.durationFrameCount&&this.completeCycle())}}class I extends H{get isCompleted(){return this._isCompleted}constructor(t,e){super(t,e),this._isCompleted=!1}on(t){return super.on(t),this}off(){return super.off(),this}resetCount(){return super.resetCount(),this._isCompleted=!1,this}getProgressRatio(){return this._isCompleted?1:this.count/this.durationFrameCount}completeCycle(){this._isCompleted=!0,this._isOn=!1,this.completeBehavior()}}p5.disableFriendlyErrors=!0;new p5;class Y{constructor(t,e,s){var i;this.p=t,this.shapeColor=s,this.isToBeRemoved=!1,this.position=t.createVector().set(e),this.velocity=t.createVector(),this.rotation=new U(Math.random()*t.TWO_PI,(i=.005*t.TWO_PI,Math.random()<.5?i:-i)),this.alphaChannelRef=new g;const n=t.random(40,100),a=t.random(40,100);this.drawer=new O(t,{draw(){t.rect(0,0,n,a,2)}},{positionRef:this.position,rotationAngleRef:this.rotation.angleReference,shapeColorRef:this.shapeColor,alphaChannelRef:this.alphaChannelRef}),this.disappearanceTimer=new I(3*t.idealFrameRate,()=>{this.isToBeRemoved=!0})}step(){this.velocity.add(0,.1),this.position.add(this.velocity),this.rotation.step(),this.disappearanceTimer.step(),this.alphaChannelRef.value=255*(1-this.disappearanceTimer.getProgressRatio())}clean(){}draw(){0!==this.alphaChannelRef.value&&this.drawer.draw()}}class N{constructor(t,e,s){this.p=t,this.petalArray=e,this.speed=25,this.position=t.createVector(Math.random()*t.nonScaledWidth,Math.random()*t.nonScaledHeight),this.randomColor=(new f).pushCandidateFromFunction(()=>{let e;return e=s?t.radians(s+t.random(-20,20)):Math.random()*t.TWO_PI,new l(t,t.color(L(40,35,e,40)),t.color(L(70,35,e,40)),!0)},36)}step(){const t=Math.random()*this.p.TWO_PI;this.position.add(this.speed*Math.cos(t),this.speed*Math.sin(t)),this.p.scalableCanvas.region.constrain(this.position,-70),this.position.set(this.p.constrain(this.position.x+this.speed*Math.cos(t),0,this.p.nonScaledWidth),this.p.constrain(this.position.y+this.speed*Math.sin(t),0,this.p.nonScaledHeight)),this.petalArray.push(new Y(this.p,this.position,this.randomColor.get()))}}new class extends p5{setCurrentRenderer(t){this.currentRenderer=t}get nonScaledWidth(){return this.scalableCanvas.nonScaledWidth}get nonScaledHeight(){return this.scalableCanvas.nonScaledHeight}get idealFrameRate(){return this._idealFrameRate}get unitAngleSpeed(){return this._unitAngleSpeed}get unitSpeed(){return this._unitSpeed}get unitAccelerationMagnitude(){return this._unitAccelerationMagnitude}constructor(t,e,s){super(t,"string"==typeof e?document.getElementById(e)||void 0:e,s),this.node=e&&"boolean"!=typeof e?"string"==typeof e?document.getElementById(e)||document.body:e:document.body,this.currentRenderer=this,this.maxCanvasRegion={width:0,height:0,getShortSideLength(){return Math.min(this.width,this.height)}},this.updateMaxCanvasRegion(),this.setFrameRate()}setFrameRate(t=60){return this.frameRate(t),t&&(this._idealFrameRate=t,this._unitAngleSpeed=2*Math.PI/this._idealFrameRate,this._unitSpeed=1/this._idealFrameRate,this._unitAccelerationMagnitude=this._unitSpeed/this._idealFrameRate),this}updateMaxCanvasRegion(){if(this.maxCanvasRegion.width=this.windowWidth,this.maxCanvasRegion.height=this.windowHeight,this.node===document.body)return;const t=this.node.getBoundingClientRect();this.maxCanvasRegion.width=t.width,this.maxCanvasRegion.height=t.height}createScalableCanvas(t,e,i){this.scalableCanvasType=t,this.scalableCanvas=new s(this,this.createScalableCanvasParameter(t,e),this.node,i)}resizeScalableCanvas(t,e){this.scalableCanvas.resize(this.createScalableCanvasParameter(t||this.scalableCanvasType,e))}createScalableCanvasParameter(t,e){this.updateMaxCanvasRegion();const n=this.maxCanvasRegion.getShortSideLength();switch(t){case i.SQUARE640x640:return{scaledWidth:n,scaledHeight:n,nonScaledShortSideLength:640};case i.RECT640x480:return{scaledWidth:n,scaledHeight:.75*n,nonScaledShortSideLength:480};case i.FULL:return{scaledWidth:this.maxCanvasRegion.width,scaledHeight:this.maxCanvasRegion.height,nonScaledShortSideLength:640};default:return e||s.DUMMY_PARAMETERS}}}(t=>{let e,s,n,a=-1;function r(){const e=function(t,e){const s=t,i=s.width,n=s.height,a=s.pixelDensity();s.loadPixels();for(let r=0;r<n;r+=1)for(let s=0;s<i;s+=1)k(t,s,r,0,0,0,a,Math.random()*e);return s.updatePixels(),s}(function(t,e,s,i,n,a,r=1){const o=t.createGraphics(e,s);o.background(i),o.strokeWeight(2);for(let h=0;h<s;h+=1){const i=Math.pow(h/(s-1),r);o.stroke(t.lerpColor(n,a,i)),o.line(0,h,e-1,h)}return o}(t,t.width,t.height,t.color(255,255,255),t.color(255,255,255),t.color(248,244,255),3),.05);return t.background(255,255,255),t.image(e,0,0),t.loadPixels(),t.pixels}t.preload=(()=>{}),t.setup=(()=>{window.noCanvas(),t.createScalableCanvas(i.FULL),t.setFrameRate(30),e=r(),t.rectMode(t.CENTER),s=new E,(n=new A(2)).pushRawArray([new N(t,s,275),new N(t,s,300)])}),t.draw=(()=>{t.pixels=e,t.updatePixels(),t.scalableCanvas.scale(),n.step(),s.step(),s.clean(),s.draw(),t.scalableCanvas.cancelScale()}),t.windowResized=(()=>{t.resizeScalableCanvas(),-1!==a&&clearTimeout(a),a=setTimeout(()=>{e=r()},200)}),t.mousePressed=(()=>{}),t.touchMoved=(()=>{})},"RectanglePetals")}();